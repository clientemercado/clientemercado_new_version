@model  ClienteMercado.Models.ResponderCotacaoRecebida

@{
    ViewBag.Title = "ClienteMercado";
    Layout = "~/Views/Shared/_Layout_internas2.cshtml";
}

<!-- OBS.: ALTERAR OS DADOS ABAIXO, ADEQUANDO-OS AOS DO USUÁRIO EMPRESA -->

<div id="tools-bar">
    <div class="container-fluid">
        <div class="caixa-botoes pull-left" id="caixa-botoes">
            <a tabindex="-1" href="#" class="btn">&nbsp;</a>
        </div>

        <div class="breadcrumb pull-left">
            <p><span style="color: blue;font-weight: bold;font-size: 8pt;"><a href="@Url.Action("PerfilUsuarioEmpresa", "UsuarioEmpresa", new { nmU = ClienteMercado.Utils.Utilitarios.MD5Crypt.Criptografar(@ViewBag.nomeUsuarioLogado), nmE = ClienteMercado.Utils.Utilitarios.MD5Crypt.Criptografar(@ViewBag.nomeEmpresaLogado), cloG = ClienteMercado.Utils.Utilitarios.MD5Crypt.Criptografar(Convert.ToString(@ViewBag.idLogradouro)), cbaiR = ClienteMercado.Utils.Utilitarios.MD5Crypt.Criptografar(Convert.ToString(@ViewBag.idBairro)), cciD = ClienteMercado.Utils.Utilitarios.MD5Crypt.Criptografar(Convert.ToString(@ViewBag.idCidade)), cesT = ClienteMercado.Utils.Utilitarios.MD5Crypt.Criptografar(Convert.ToString(@ViewBag.idEstado)), ccouT = ClienteMercado.Utils.Utilitarios.MD5Crypt.Criptografar(Convert.ToString(@ViewBag.idPais)) })" id="irParaOInicio" style="font-size: 9pt;">@ViewBag.deOndeVim</a></span> > <span font-weight bold;font-size 8pt;>@ViewBag.ondeEstou</span></p>
        </div>
    </div>
</div>
<!-- FIM DA BARRA DE FERRAMENTAS -->
<!-- Menu Lateral -->
<div id="sidebar-wrapper">
    <div class="corpo-menu">
        <div class="divider"></div>
        <ul id="menu-content" class="menu-content">

            <li data-toggle="collapse" data-target="#cotacao_enviada" class="collapsed">
                <a href="#"><i class="fa fa-list-ul"></i> Relatórios <i class="fa fa-angle-right pull-right"></i></a>
            </li>
            <ul class="sub-menu collapse" id="cotacao_enviada">
                <li><a href="#">Relatório 1</a></li>
                <li><a href="#">Relatório 2</a></li>
                <li><a href="#">Relatório 3</a></li>
                <li><a href="#">Relatório 4</a></li>
            </ul>
            <li class="separador"></li>
            <li data-toggle="collapse" data-target="#configuracoes" class="collapsed">
                <a href="#"><i class="fa fa-gear"></i> Configurações <i class="fa fa-angle-right pull-right"></i></a>
            </li>
            <ul class="sub-menu collapse" id="configuracoes">
                <li><a href="#">Dados da Empresa</a></li>
                <li><a href="#">Dados Usuário Master</a></li>
                <li><a href="#">Outros Usuários da Empresa</a></li>
                <li><a href="#">Liberação de Cadastro</a></li>
            </ul>

        </ul>
        <div id="logo-clientemercado">
            <img src="@Url.Content("~/Content/images/logo_branca.png")" alt="">
            <p>2015 &copy; Todos os direitos reservados.</p>
        </div>
    </div>
</div>
<!-- /#sidebar-wrapper -->
<div id="page-content-wrapper">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">

                <div class="col-md-12" id="tabela1">
                    <!-- Formulário de RESPOSTA da COTAÇÃO -->
                    @using (Html.BeginForm(new { id = "formListaGridItensCotados" }))
                    {
                        <table class="table table-striped table-ordered table-bordered col-md-4">
                            <tr>
                                <td style="border:0px;">
                                    <label for="">Cotação a responder:</label>
                                    @Html.TextBoxFor(m => m.NOME_COTACAO_RECEBIDA, new { @class = "form-control", @id = "NOME_COTACAO_RECEBIDA", @style = "width:300px; font-weight: bold" })
                                </td>
                                <td style="border:0px;  margin-top:23px;">
                                    <label for="">Status:</label>
                                    @if ((Model.STATUS_COTACAO_RECEBIDA == "ABERTA") || (Model.STATUS_COTACAO_RECEBIDA == "EM ANDAMENTO"))
                                    {
                                        @Html.TextBoxFor(m => m.STATUS_COTACAO_RECEBIDA, new { @class = "form-control", @id = "STATUS_COTACAO_RECEBIDA", @style = "width:150px; color: #FF0000; font-weight: bold" })
                                    }
                                    else
                                    {
                                        @Html.TextBoxFor(m => m.STATUS_COTACAO_RECEBIDA, new { @class = "form-control", @id = "STATUS_COTACAO_RECEBIDA", @style = "width:150px; color: #0101DF; font-weight: bold" })
                                    }
                                </td>
                                <td style="border:0px;">
                                    <label for="">Categoria:</label>
                                    @Html.TextBoxFor(m => m.CATEGORIA_COTACAO_RECEBIDA, new { @class = "form-control", @id = "CATEGORIA_COTACAO_RECEBIDA", @style = "width:300px; font-weight: bold" })
                                </td>
                                <td style="border:0px; margin-top:23px;">
                                    <label for="">% Respondida: </label>
                                    @if (Convert.ToDouble(Model.PERCENTUAL_RESPONDIDA_COTACAO_RECEBIDA) < Convert.ToDouble(50.01))
                                    {
                                        @Html.TextBoxFor(m => m.PERCENTUAL_RESPONDIDA_COTACAO_RECEBIDA, new { @class = "form-control", @id = "PERCENTUAL_RESPONDIDA_COTACAO_RECEBIDA", @style = "width:100px; color: #FF0000; font-weight: bold" })
                                    }
                                    else
                                    {
                                        @Html.TextBoxFor(m => m.PERCENTUAL_RESPONDIDA_COTACAO_RECEBIDA, new { @class = "form-control", @id = "PERCENTUAL_RESPONDIDA_COTACAO_RECEBIDA", @style = "width:100px; color: #0101DF; font-weight: bold" })
                                    }
                                </td>
                            </tr>
                        </table>

                        <div role="tabpanel" class="" id="listaItensCotacao">
                            <table id="lista_itens_cotacao" class="table table-striped table-ordered table-bordered col-md-4">
                                <thead>
                                    <tr style="background-color: #e8e8e8;">
                                        <th align="left" style="border: 0px">
                                            <i class="fa fa-shopping-cart"></i> <strong>PRODUTOS COTADOS: </strong>
                                        </th>
                                    </tr>

                                    @*<div align="right"><strong><a href="#" data-toggle="modal" data-target="#modal_comunicacao_entre_cotante_ecotado" style="text-decoration:none" title="Comunicação entre Cliente e Empresa"><i class="fa fa-weixin fa-2x"></i> Perguntas & Respostas</a></strong></div>*@

                                    <!-- VERIFICA SE TEM NOVA NOTIFICAÇÃO -->
                                    @if (ViewBag.temaNaoTemNotificacao == "naoTem")
                                    {
                                        <div align="right" id="comunicacao1" style=""><strong><a href="#" class="verPergunta" data-toggle="modal" data-target="#modal_comunicacao_entre_cotante_ecotado" style="text-decoration:none; height:auto; transition:all 100ms linear; z-index:999;" title="Comunicação entre Cliente e Empresa"><i class="fa fa-weixin fa-2x"></i> Perguntas & Respostas</a></strong></div>
                                    }
                                    else
                                    {
                                        @*<div class="balao_informativo">Você tem 1 nova mensagem</div>*@
                                        <div align="right" id="comunicacao1" style=""><strong><a href="#" class="verPergunta" data-toggle="modal" data-target="#modal_comunicacao_entre_cotante_ecotado" style="text-decoration:none; height:auto; transition:all 100ms linear; z-index:999;" title="Você tem 1 comunicação"><font color="#FF0000"><i class="fa fa-weixin fa-2x"></i> </font> Perguntas & Respostas</a></strong></div>
                                    }

                                </thead>
                                <!-- Exibe o Grid com a lista dos PRODUTOS cotados -->
                                @{
                                    Html.RenderPartial("GridItensCotados");
                                }

                                <td style="border:0px;">
                                    <label for="">Observações:</label>
                                    @Html.TextAreaFor(m => m.OBSERVACAO_COTACAO_USUARIO_COTANTE, new { @cols = 60, @rows = 2, @class = "form-control", @placeholder = "Digite aqui sua observação para esta cotação...", @id = "OBSERVACAO_COTACAO_USUARIO_COTANTE" })
                                </td>
                            </table>
                        </div>

                        @*<div class="col-md-12" id="tabela5">*@
                            <br />
                            <table class="table table-striped table-ordered table-bordered col-md-4">
                                <tr>
                                    <td style="border:0px;">
                                        <label for="">Forma de Pgto:</label>
                                        @Html.TextBoxFor(m => m.CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE, new { @maxlenght = 50, @class = "form-control", @style = "width:200px;", @placeholder = "Informe...", @id = "CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE" })
                                    </td>
                                    <td style="border:0px;">
                                        <label for="">Tipo de Frete:</label>
                                        @Html.DropDownList("ID_TIPO_DE_FRETE", Model.ListagemTiposDeFrete, new { @class = "form-control", @id = "ID_TIPO_DE_FRETE" })
                                    </td>
                                    <td style="border:0px;" id="percentualDesconto">
                                        <div>
                                            <label for="">% Desc.:</label>
                                            @Html.TextBoxFor(m => m.PERCENTUAL_DESCONTO_ASER_APLICADO, new { @maxlenght = 20, @class = "form-control sonums", @style = "width:70px;", @placeholder = "0,00", @onKeydown = "Formata(this,20,event,2)", @id = "PERCENTUAL_DESCONTO_ASER_APLICADO" })
                                        </div>
                                    </td>
                                    <td style="border:0px;" id="aplicarDescontos">
                                        <div>
                                            <label for="">&nbsp;Aplicar Desconto:</label>
                                            <br />

                                            <!-- Seta os TIPOS de DESCONTO -->
                                            @if ((ViewBag.tipoDesconto == 0) || (ViewBag.tipoDesconto == 1))
                                            {
                                                <label class="radio-inline">@Html.RadioButton("desconto", 1, true, new { @class = "radio0", @id = "desconto1" })&nbsp;Não aplicar</label>
                                                <br />
                                                <label class="radio-inline">@Html.RadioButton("desconto", 2, new { @class = "radio0", @id = "desconto2" })&nbsp;Em cada Produto</label>
                                                <br />
                                                <label class="radio-inline">@Html.RadioButton("desconto", 3, new { @class = "radio0", @id = "desconto3" })&nbsp;Sobre o valor do Lote</label>
                                            }
                                            else if (ViewBag.tipoDesconto == 2)
                                            {
                                                <label class="radio-inline">@Html.RadioButton("desconto", 1, new { @class = "radio0", @id = "desconto1" })&nbsp;Não aplicar</label>
                                                <br />
                                                <label class="radio-inline">@Html.RadioButton("desconto", 2, true, new { @class = "radio0", @id = "desconto2" })&nbsp;Em cada Produto</label>
                                                <br />
                                                <label class="radio-inline">@Html.RadioButton("desconto", 3, new { @class = "radio0", @id = "desconto3" })&nbsp;Sobre o valor do Lote</label>
                                            }
                                            else if (ViewBag.tipoDesconto == 3)
                                            {
                                                <label class="radio-inline">@Html.RadioButton("desconto", 1, new { @class = "radio0", @id = "desconto1" })&nbsp;Não aplicar</label>
                                                <br />
                                                <label class="radio-inline">@Html.RadioButton("desconto", 2, new { @class = "radio0", @id = "desconto2" })&nbsp;Em cada Produto</label>
                                                <br />
                                                <label class="radio-inline">@Html.RadioButton("desconto", 3, true, new { @class = "radio0", @id = "desconto3" })&nbsp;Sobre o valor do Lote</label>
                                            }

                                            @if (ViewBag.tipoDesconto > 1)
                                            {
                                                @Html.HiddenFor(m => m.APLICACAO_DO_DESCONTO, new { @id = "APLICACAO_DO_DESCONTO", @maxlenght = 1, @size = 1, @Value = @ViewBag.tipoDesconto })
                                            }
                                            else
                                            {
                                                @Html.HiddenFor(m => m.APLICACAO_DO_DESCONTO, new { @id = "APLICACAO_DO_DESCONTO", @maxlenght = 1, @size = 1, @Value = '1' })
                                            }
                                        </div>
                                    </td>
                                    <td style="border:0px;">
                                        <label for="">R$ Total do lote:</label>
                                        @Html.TextBoxFor(m => m.VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR, new { @maxlenght = 20, @class = "form-control sonums", @style = "width:120px;", @placeholder = "0,00", @id = "VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR" })
                                        <div id="comDescontoSobreLoteAplicado" class="desconto">
                                            <font size="1" color="#0101DF"><b>* Lote c/ desconto</b></font>
                                        </div>
                                    </td>
                                    <td style="border:0px;" id="">
                                        @{
                                            <!-- Controla a exibição dos botões -->
                                            if ((Model.STATUS_COTACAO_RECEBIDA == "ABERTA") || (Model.STATUS_COTACAO_RECEBIDA == "EM ANDAMENTO") && (ViewBag.cotacaoRespondida == "Nao"))
                                            {
                                                <a tabindex="-1" href="#" id="responderACotacao" class="btn btn-primary btn-large" style="margin-top:18px; float: right;"><i class="fa fa-sign-out"></i> Responder a Cotação</a>
                                            }
                                            else if ((Model.STATUS_COTACAO_RECEBIDA == "EM ANDAMENTO") && (ViewBag.cotacaoRespondida == "Sim"))
                                            {
                                                <a tabindex="-1" href="#" id="editarACotacao" class="btn btn-warning btn-large" style="margin-top:18px; float: right;"><i class="fa fa-sign-out"></i> Alterar a Cotação</a>
                                            }
                                        }
                                    </td>
                                </tr>
                            </table>
                        @*</div>*@
                    }
                    <!-- Fim do formulário de RESPOSTA da COTAÇÃO -->

                    <div role="tabpanel" class="" id="listaDeFornecedoresCotados">
                        <table id="lista_fornecedores_cotacao" class="table table-striped table-ordered table-bordered col-md-4">
                            <thead>
                                <tr style="background-color: #e8e8e8;">
                                    <th align="center" colspan="4">
                                        <i class="fa fa-pencil-square"></i> <strong>FORNECEDORES RESPONDENDO: </strong>
                                    </th>
                                </tr>
                            </thead>
                            <!-- Exibe o Grid com a lista dos FORNECEDORES cotados -->
                            @{
                                Html.RenderPartial("GridFornecedoresConcorrentesCotados");
                            }
                        </table>
                    </div>

                    @Html.HiddenFor(m => m.ID_EMPRESA, new { @id = "ID_EMPRESA", @Value = @ViewBag.idEmpresa })
                    @Html.HiddenFor(m => m.ID_USUARIO, new { @id = "ID_USUARIO", @Value = @ViewBag.idUsuarioLogado })
                    @Html.HiddenFor(m => m.ID_COTACAO_FILHA, new { @id = "ID_COTACAO_FILHA", @Value = @ViewBag.idCotacaoFilha })
                    @Html.HiddenFor(m => m.ID_COTACAO_MASTER, new { @id = "ID_COTACAO_MASTER", @Value = @ViewBag.idCotacaoMaster })
                    @Html.HiddenFor(m => m.ID_CODIGO_USUARIO_COTANTE, new { @id = "ID_CODIGO_USUARIO_COTANTE", @Value = @ViewBag.idUsuarioCotante })
                    @Html.HiddenFor(m => m.TIPO_COTACAO_RECEBIDA, new { @id = "TIPO_COTACAO_RECEBIDA", @Value = @ViewBag.tipoCotacaoRecebida })
                    @Html.HiddenFor(m => m.COTACAO_RESPONDIDA, new { @id = "COTACAO_RESPONDIDA", @Value = @ViewBag.cotacaoRespondida })
                </div>

                <!-- Janelas MODAL - COMUNICAÇÃO ENTRE COTANTES E COTADOS -->
                <div id="modal_comunicacao_entre_cotante_ecotado" class="modal fade" role="dialog">
                    <br /><br /><br />
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header" style="background-color: #337ab7">
                                <button type="button" class="close habiliteCampo" data-dismiss="modal"><i class="fa fa-times"></i></button>
                                <h4 class="modal-title"><font color=white><i class="fa fa-weixin fa-2x"></i> Perguntas & Respostas</font></h4>
                            </div>
                            <div class="modal-body">

                                <!-- TRANSCRIÇÃO do DIÁLOGO ENTRE COTANTE e FORNECEDOR -->
                                <div role="tabpanel" class="tab-pane active" id="dialogos">
                                    <table id="dialogo_entre_cotante_efornecedor" class="table table-striped table-hover"></table>
                                </div>

                                <div id="texto_chat_alternativo" style="border:0px; display:none;">
                                    <label for="">Resposta ao Comprador:</label>
                                    @Html.TextAreaFor(m => m.TEXTO_CHAT_COTACAO_USUARIO_COTANTE_ALTERNATIVO, new { @cols = 20, @rows = 1, @class = "form-control", @placeholder = "Escreva sua pergunta...", @id = "TEXTO_CHAT_COTACAO_USUARIO_COTANTE_ALTERNATIVO" })
                                </div>
                                <div id="texto_chat_principal" style="border:0px; display:none">
                                    <label for="">Resposta ao Comprador:</label>
                                    @Html.TextAreaFor(m => m.TEXTO_CHAT_COTACAO_USUARIO_COTANTE, new { @cols = 20, @rows = 3, @class = "form-control", @placeholder = "Escreva sua pergunta...", @id = "TEXTO_CHAT_COTACAO_USUARIO_COTANTE" })
                                    <div align="right"><small class="caracteres"></small></div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <div id="botao_enviar" class="col-md-12" style="align-content:center; display:none">
                                    <a href="#" id="enviarPerguntaOuResposta" class="btn btn-primary btn-large" title="Enviar conteúdo digitado como PERGUNTA ou RESPOSTA"><i class="fa fa-share"></i> Enviar</i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Fim janela MODAL-->

            </div>
        </div>
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script type="text/javascript">
        $(document).ready(function () {
            //Desabilitar botão direito do mouse
            $(document).bind("contextmenu", function (e) {
                //return false;
            });

            //Desabilitando os campos de identificação da COTAÇÃO
            $('#NOME_COTACAO_RECEBIDA').attr('readonly', true);
            $('#CATEGORIA_COTACAO_RECEBIDA').attr('readonly', true);
            $('#TIPO_COTACAO_RECEBIDA').attr('readonly', true);
            $('#PERCENTUAL_RESPONDIDA_COTACAO_RECEBIDA').attr('readonly', true);
            $('#STATUS_COTACAO_RECEBIDA').attr('readonly', true);
            $('#DATA_CRIACAO_COTACAO_RECEBIDA').attr('readonly', true);
            $('#DATA_ENCERRAMENTO_COTACAO_RECEBIDA').attr('readonly', true);
            $("#outra_cidade_avulsa").hide();

            if ($('#PERCENTUAL_DESCONTO_ASER_APLICADO').val() == 0) {
                //$("#percentualDesconto").hide();
                //$("#aplicarDescontos").hide();
                $(".desconto").hide();
            }

            $(".valorResposta").maskMoney({ decimal: ",", thousands: "." });

            $("#QUANTIDADE_ITEM_COTACAO_DIRECIONADA").maskMoney({ decimal: ",", thousands: "." });

            //Verifica se a COTAÇÃO RESPONDIDA = 'SIM'
            if ($("#COTACAO_RESPONDIDA").val() == 'Sim') {
                //SETA ou NÃO os chekboxes dos PRODUTOS COTADOS
                $(".check").attr("disabled", true);
            }

            //Verifica se a COTAÇÃO está com o status de 'ENCERRADA'
            if ($("#STATUS_COTACAO_RECEBIDA").val() == 'ENCERRADA') {
                //Desabilitando demais campos da COTAÇÃO
                $('#OBSERVACAO_COTACAO_USUARIO_COTANTE').attr('readonly', true);
                $('#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE').attr('readonly', true);
                $('#ID_TIPO_DE_FRETE').attr('readonly', true);
                $('#PERCENTUAL_DESCONTO_ASER_APLICADO').attr('readonly', true);
                $(".radio0").attr("disabled", true);
                $('#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR').attr('readonly', true);
                $('#responderACotacao').hide();
                $('#TEXTO_CHAT_COTACAO_USUARIO_COTANTE_ALTERNATIVO').attr('readonly', true);
                $('#TEXTO_CHAT_COTACAO_USUARIO_COTANTE').attr('readonly', true);
                $(".radio0").attr("disabled", true);

                //Desabilitar campos de RESPOSTA da COTAÇÃO
                var listaIdsProdutos = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array

                for (var i = 0; i < listaIdsProdutos.length; i++) {
                    var valorProduto = "#inValorProduto_" + listaIdsProdutos[i];
                    var valorTotalProduto = "#inValorTotal_" + +listaIdsProdutos[i];

                    $(valorProduto).attr('readonly', true);
                    $(valorTotalProduto).attr('readonly', true);
                }

                //SETA ou NÃO os chekboxes dos PRODUTOS COTADOS
                $(".check").attr("disabled", true);

                //Esconder botões de ENVIO ou EDIÇÃO da COTAÇÃO
                $("#responderACotacao").hide();
                $("#editarACotacao").hide();
            }

            //Atribuindo valor a alguns campos da View
            //$("#APLICACAO_DO_DESCONTO").val(1); //Começa com 'NÃO APLICAR'

            //Exibe os LOCAIS onde foram aplicados os DESCONTO´S, para o caso de EDIÇÃO de COTAÇÃO
            if (($('#APLICACAO_DO_DESCONTO').val() == 0) || ($('#APLICACAO_DO_DESCONTO').val() == 1))
            {
                //NÃO APLICAR DESCONTO ALGUM
                var listaIdsProdutos = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array

                for (var i = 0; i < listaIdsProdutos.length; i++) {
                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];

                    $(exibicaoDesconto).hide();
                }

                $('#comDescontoSobreLoteAplicado').hide();

                if ($("#COTACAO_RESPONDIDA").val() == "Nao") {
                    //Inicializa o STRINGÃO de ID´s para o caso de COTAÇÃO NÃO RESPONDIDA
                    $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val('');
                }
            }
            else if ($('#APLICACAO_DO_DESCONTO').val() == 2) {
                //APLICAR DESCONTO NOS PRODUTOS
                var listaIdsProdutos = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array

                for (var i = 0; i < listaIdsProdutos.length; i++) {
                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];

                    $(exibicaoDesconto).show();
                }

                $('#comDescontoSobreLoteAplicado').hide();
            }
            else if ($('#APLICACAO_DO_DESCONTO').val() == 3) {
                //APLICAR DESCONTO NO LOTE DE PRODUTOS
                var listaIdsProdutos = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array

                for (var i = 0; i < listaIdsProdutos.length; i++) {
                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];

                    $(exibicaoDesconto).hide();
                }

                $('#comDescontoSobreLoteAplicado').show();
            }

            //Iniciando como vazio os quadros de IMAGENS ao ADICIONAR FOTOS PRODUTOS ALTERNATIVOS
            $('#imagem_1').attr("src", "");
            $('#imagem_2').attr("src", "");
            $('#imagem_3').attr("src", "");
            $('#imagem_4').attr("src", "");

            //Desabilitando ícone de EXCLUSÃO das imagens dos quadros
            $("#excluir_imagem_1").hide();
            $("#excluir_imagem_2").hide();
            $("#excluir_imagem_3").hide();
            $("#excluir_imagem_4").hide();
            $("#excluir_imagem_5").hide();
            $("#ver_excluir_imagem_1").hide();
            $("#ver_excluir_imagem_2").hide();
            $("#ver_excluir_imagem_3").hide();
            $("#ver_excluir_imagem_4").hide();
            $("#ver_excluir_imagem_5").hide();

            $("#ID_PRODUTO_FOTOS").val("");
            $("#ID_QUADRO_FOTOS").val("");
            $("#LISTA_NOMES_FOTOS_PRODUTOS_ALTERNATIVOS").val("");
            $("#BOTAO_CONFIRMAR_FOTOS").val(0);

            //========================================================================================
            //Armazena o ID da EMPRESA FORNECEDORA e EXIBE RESPOSTAS das PERGUNTAS
            $(".verPergunta").click(function () {
                //Carregar DIÁLOGO do COTANTE com o FORNECEDOR
                $('#dialogo_entre_cotante_efornecedor td').parent().remove(); //Limpar / Remover linha

                $.ajax({
                    type: "POST",
                    url: "/UsuarioEmpresa/CarregarDialogoEntreCotanteEFornecedor",
                    dataType: "json",
                    data: {
                        'idCotacaoFilha': $("#ID_COTACAO_FILHA").val(),
                        'tipoCotacao': $("#TIPO_COTACAO_RECEBIDA").val()
                    },
                    success: function (data) {
                        debugger;
                        var quantosDialogos = data.length;
                        var contadorMsg = 1;

                        if (quantosDialogos > 0) {
                            $.each(data, function (index, chat) {

                                //Inserir no Grid
                                if (contadorMsg & 1) {
                                    $('<table><tr><td width="2%"></td><td width="90%"><font color="#337ab7"><i class="fa fa-comment fa-2x"></i> </font><font color="#000000">' + chat.texto_chat + '<font color="#A9A9A9"> - ' + chat.data_chat + '</font></font></td></tr></table>').appendTo('#dialogo_entre_cotante_efornecedor');
                                } else {
                                    $('<table><tr style="border-style: dotted; border-bottom-width: 1px; border-top-width: 0; border-right-width: 0; border-left-width: 0; border-bottom-color: #C0C0C0;"><td><font color="#FFFFFF">vazio</font></td><td></td><td width="100%"><font color=""><i class="fa fa-comments fa-2x"></i> </font><font color="#000000">' + chat.texto_chat + '</font></td></tr></table>').appendTo('#dialogo_entre_cotante_efornecedor');
                                }

                                contadorMsg = (parseInt(contadorMsg) + parseInt(1));
                            });

                            //Controla todo o processo de CHAT
                            debugger;
                            if (quantosDialogos & 1) {
                                //Habilita campo para PERGUNTA / RESPOSTA
                                $("#texto_chat_alternativo").show();
                            }
                            else {
                                //Desabilita campo para PERGUNTA / RESPOSTA
                                $("#texto_chat_alternativo").hide();
                            }
                        }
                        //else {
                        //    //Habilita campo para PERGUNTA / RESPOSTA
                        //    $("#texto_chat_alternativo").show();
                        //}
                    }
                });

            });

            //Desabilita / Habilita o campo para digitação do texto de PERGUNTA / RESPOSTA
            $("#TEXTO_CHAT_COTACAO_USUARIO_COTANTE_ALTERNATIVO").focus(function () {
                $("#texto_chat_alternativo").hide();
                $("#texto_chat_principal").show();
                $("#botao_enviar").show();

                $("#TEXTO_CHAT_COTACAO_USUARIO_COTANTE").focus();
            });

            $("#TEXTO_CHAT_COTACAO_USUARIO_COTANTE").focus(function () {
                $("#botao_enviar").show();
            });

            //Registra a PERGUNTA ou RESPOSTA, enviando-a ao FORNECEDOR COTADO
            $("#enviarPerguntaOuResposta").click(function () {
                if ($("#TEXTO_CHAT_COTACAO_USUARIO_COTANTE").val() != '') {
                    textoPerguntaOuResposta = $("#TEXTO_CHAT_COTACAO_USUARIO_COTANTE").val();

                    $.ajax({
                        url: "/UsuarioEmpresa/EnviarRespostaParaAPerguntaDoCompradorNaCotacao",
                        dataType: 'json',
                        cache: false,
                        async: true,
                        data: {
                            'idCotacaoFilha': $('#ID_COTACAO_FILHA').val(),
                            'idEmpresaCotada': $('#ID_EMPRESA').val(),
                            'idUsuarioCotante': $('#ID_CODIGO_USUARIO_COTANTE').val(),
                            'textoPerguntaOuResposta': textoPerguntaOuResposta,
                            'tipoCotacao': $("#TIPO_COTACAO_RECEBIDA").val()
                        },
                        success: function (data) {
                            $("#texto_chat_principal").val('');
                            $("#texto_chat_principal").hide();
                            $("#texto_chat_alternativo").hide();
                            $("#enviarPerguntaOuResposta").hide();

                            //Carregar DIÁLOGO do COTANTE com o FORNECEDOR
                            $('#dialogo_entre_cotante_efornecedor td').parent().remove(); //Limpar / Remover linha

                            $.ajax({
                                type: "POST",
                                url: "/UsuarioEmpresa/CarregarDialogoEntreCotanteEFornecedor",
                                dataType: "json",
                                data: {
                                    'idCotacaoFilha': $("#ID_COTACAO_FILHA").val(),
                                    'tipoCotacao': $("#TIPO_COTACAO_RECEBIDA").val()
                                },
                                success: function (data) {
                                    debugger;
                                    var quantosDialogos = data.length;
                                    var contadorMsg = 1;

                                    if (quantosDialogos > 0) {
                                        $.each(data, function (index, chat) {

                                            //Inserir no Grid
                                            if (contadorMsg & 1) {
                                                $('<table><tr><td width="2%"></td><td width="90%"><font color="#337ab7"><i class="fa fa-comment fa-2x"></i> </font><font color="#000000">' + chat.texto_chat + '<font color="#A9A9A9"> - ' + chat.data_chat + '</font></font></td></tr></table>').appendTo('#dialogo_entre_cotante_efornecedor');
                                            } else {
                                                $('<table><tr style="border-style: dotted; border-bottom-width: 1px; border-top-width: 0; border-right-width: 0; border-left-width: 0; border-bottom-color: #C0C0C0;"><td><font color="#FFFFFF">vazio</font></td><td></td><td width="100%"><font color=""><i class="fa fa-comments fa-2x"></i> </font><font color="#000000">' + chat.texto_chat + '</font></td></tr></table>').appendTo('#dialogo_entre_cotante_efornecedor');
                                            }

                                            contadorMsg = (parseInt(contadorMsg) + parseInt(1));
                                        });

                                        //Controla todo o processo de CHAT
                                        if (quantosDialogos & 1) {
                                            //Habilita campo para PERGUNTA / RESPOSTA
                                            $("#texto_chat_alternativo").show();

                                            //Muda STATUS do CHAT (informa que não há novas mensagens)
                                            $("#comunicacao1").html("<strong><a href='#' class='verPergunta' data-toggle='modal' data-target='#modal_comunicacao_entre_cotante_ecotado' style='text-decoration:none; height:auto; transition:all 100ms linear; z-index:999;' title='Você tem 1 comunicação'><font color='#FF0000'><i class='fa fa-weixin fa-2x'></i> </font> Perguntas & Respostas</a></strong>");
                                        }
                                        else {
                                            //Desabilita campo para PERGUNTA / RESPOSTA
                                            $("#texto_chat_alternativo").hide();

                                            //Muda STATUS do CHAT (informa que há novas mensagens)
                                            $("#comunicacao1").html("<strong><a href='#' class='verPergunta' data-toggle='modal' data-target='#modal_comunicacao_entre_cotante_ecotado' style='text-decoration:none; height:auto; transition:all 100ms linear; z-index:999;' title='Comunicação entre Cliente e Empresa'><i class='fa fa-weixin fa-2x'></i> Perguntas & Respostas</a></strong>");
                                        }
                                    }
                                    else {
                                        //Habilita campo para PERGUNTA / RESPOSTA
                                        $("#texto_chat_alternativo").show();
                                    }
                                }
                            });
                        }
                    });
                }
                else {
                    alert("ATENÇÃO!!\n\nDigite a RESPOSTA ao questionamento do comprador!");

                    $("#TEXTO_CHAT_COTACAO_USUARIO_COTANTE").val('');
                    $("#TEXTO_CHAT_COTACAO_USUARIO_COTANTE").focus();
                }
            });

            //Contador REGRESSIVO de caracteres do campo TEXTAREA
            $(document).on("input", "#TEXTO_CHAT_COTACAO_USUARIO_COTANTE", function () {
                var limite = 200;
                var informativo = " caracteres restantes";
                var caracteresDigitados = $(this).val().length;
                var caracteresRestantes = limite - caracteresDigitados;

                if (caracteresRestantes <= 0) {
                    var comentario = $("#TEXTO_CHAT_COTACAO_USUARIO_COTANTE").val();
                    $("#TEXTO_CHAT_COTACAO_USUARIO_COTANTE").val(comentario.substr(0, limite));
                    $(".caracteres").text("0 " + informativo);
                } else {
                    $(".caracteres").text(caracteresRestantes + " " + informativo);
                }
            });

            //HABILITA / DESABILITA campos do CHAT
            $(".habiliteCampo").click(function () {
                $("#texto_chat_principal").val('');
                $("#texto_chat_principal").hide();
                //$("#texto_chat_alternativo").show();

                //Seta o STATUS no CHAT, informando se existem novas mensagens no CHAT ou não
                $.ajax({
                    type: "POST",
                    url: "/UsuarioCotante/CarregarDialogoEntreCotanteEFornecedor",
                    dataType: "json",
                    data: {
                        'idCotacaoFilha': $("#ID_COTACAO_FILHA").val(),
                        'tipoCotacao': $("#TIPO_COTACAO_RECEBIDA").val()
                    },
                    success: function (data) {
                        debugger;
                        var quantosDialogos = data.length;
                        //var contadorMsg = 1;

                        if (quantosDialogos > 0) {

                            //Controla o STATUS do CHAT
                            if (quantosDialogos & 1) {
                                //Muda STATUS do CHAT (informa que não há novas mensagens)
                                $("#comunicacao1").html("<strong><a href='#' class='verPergunta' data-toggle='modal' data-target='#modal_comunicacao_entre_cotante_ecotado' style='text-decoration:none; height:auto; transition:all 100ms linear; z-index:999;' title='Você tem 1 comunicação'><font color='#FF0000'><i class='fa fa-weixin fa-2x'></i> </font> Perguntas & Respostas</a></strong>");
                            }
                            else {
                                //Muda STATUS do CHAT (informa que há novas mensagens)
                                $("#comunicacao1").html("<strong><a href='#' class='verPergunta' data-toggle='modal' data-target='#modal_comunicacao_entre_cotante_ecotado' style='text-decoration:none; height:auto; transition:all 100ms linear; z-index:999;' title='Comunicação entre Cliente e Empresa'><i class='fa fa-weixin fa-2x'></i> Perguntas & Respostas</a></strong>");
                            }
                        }
                    }
                });

            });
            //========================================================================================

            //Seta valores que decidem onde será aplicado o DESCONTO, caso haja
            $(".radio0").click(function () {
                var desconto = $(this).attr('id');
                var listaIdsProdutos = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array
                var descontoAAplicar = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val();
                var totalDoLote = "";
                var totalDoLoteSomaAnterior = $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val();

                if (totalDoLote == "") {
                    totalDoLote = 0;
                }

                if (desconto == "desconto1") {
                    //NÃO APLICAR DESCONTO
                    $("#APLICACAO_DO_DESCONTO").val(1);
                    $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val('');

                            if (listaIdsProdutos.length > 0) {
                                for (var i = 0; i < listaIdsProdutos.length; i++) {
                                    var totalCalculo = 0;
                                    var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                    var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                    var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                                    var multiplicador = "";

                                    if (i > 0) {
                                        if (($(valorRespondido).val() != "") || ($(valorRespondido).val() > 0)) {
                                            if (document.getElementById(listaIdsProdutos[i]).checked == true) {
                                                //Calcula o VALOR TOTAL
                                                var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                                var multiplicando = new String($(valorRespondido).val());

                                                multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                                multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                                totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                                $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                                $(exibicaoDesconto).hide();

                                                //Atualizar o TOTAL do LOTE, com os valores com DESCONTO
                                                if (parseFloat(totalDoLote) > 0) {
                                                    totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                                }

                                                if (parseFloat(totalCalculo) > 0) {
                                                    totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                                    $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                                }
                                            } else {
                                                //Coloca um valor zerado no campo
                                                $(campoRecebeResultado).val(moeda(totalCalculo, 0, ",", "."));
                                            }
                                        }
                                    }
                                }
                            }

                        //Desativar exibição de DESCONTO APLICADO para o LOTE
                        $("#comDescontoSobreLoteAplicado").hide();

                        $("#PERCENTUAL_DESCONTO_ASER_APLICADO").focus();
                }
                else if (desconto == "desconto2") {
                    //APLICAR DESCONTO SOBRE O VALOR DE CADA UM DOS PRODUTOS COTADOS
                    $("#APLICACAO_DO_DESCONTO").val(2); //Setando TIPO de DESCONTO escolhido

                    if ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "") {
                        if (listaIdsProdutos.length > 0) {
                            for (var i = 0; i < listaIdsProdutos.length; i++) {
                                if (i > 0) {
                                    var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                    var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                    var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                    var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                                    var valorASerAplicadoODesconto = $(valorRespondido).val().replace(".", "").replace(".", "").replace(",", ".");
                                    var valorDoDesconto = 0;
                                    var valorPosDesconto = 0;
                                    var totalCalculo = 0;
                                    var multiplicador = "";
                                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];

                                    //Calculando o DESCONTO
                                    valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto))/100);
                                    valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                                    //Calcula o VALOR TOTAL aplicado o DESCONTO
                                    var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                    var multiplicando = new String(valorPosDesconto);

                                    multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                    totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                    $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                    //Ativar exibição de DESCONTO APLICADO após valor do PRODUTO
                                    $(exibicaoDesconto).show();

                                    //Atualizar o TOTAL do LOTE, com os valores com DESCONTO
                                    if (parseFloat(totalDoLote) > 0) {
                                        totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                    }

                                    if (parseFloat(totalCalculo) > 0) {
                                        totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                        $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                    }
                                }
                            }
                        }
                    }
                    else {
                        alert("ATENÇÃO!!!\n\nNão foi informado um VALOR PERCENTUAL de DESCONTO a ser aplicado.");

                        $("#PERCENTUAL_DESCONTO_ASER_APLICADO").focus();
                    }

                    //Ativar exibição de DESCONTO APLICADO para o LOTE
                    $("#comDescontoSobreLoteAplicado").hide();
                }
                else if (desconto == "desconto3") {
                    //APLICAR DESCONTO SOBRE O VALOR TOTAL DO LOTE DE PRODUTOS
                    $("#APLICACAO_DO_DESCONTO").val(3);

                    //Atualizar campos dos PRODUTOS, anulando descontos aplicados em seus valores
                    if (($(valorRespondido).val() != "") || ($(valorRespondido).val() > 0)) {
                        if (listaIdsProdutos.length > 0) {
                            for (var i = 0; i < listaIdsProdutos.length; i++) {
                                var totalCalculo = 0;
                                var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                                var multiplicador = "";

                                if (i > 0) {
                                    if (document.getElementById(listaIdsProdutos[i]).checked == true) {
                                        //Calcula o VALOR TOTAL
                                        var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                        var multiplicando = new String($(valorRespondido).val());

                                        multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                        multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                        totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                        $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                        $(exibicaoDesconto).hide();

                                        //Atualizar o TOTAL do LOTE, com os valores com DESCONTO
                                        if (parseFloat(totalDoLote) > 0) {
                                            totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                        }

                                        if (parseFloat(totalCalculo) > 0) {
                                            totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                            $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                        }
                                    } else {
                                        //Coloca um valor zerado no campo
                                        $(campoRecebeResultado).val(moeda(totalCalculo, 0, ",", "."));
                                    }
                                }
                            }
                        }
                    }

                    if ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "") {
                        var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                        var valorASerAplicadoODesconto = $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val().replace(".", "").replace(".", "").replace(",", ".");
                        var valorDoDesconto = 0;
                        var valorPosDesconto = 0;

                        //Calculando o DESCONTO
                        valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                        valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                        $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda(valorPosDesconto, 2, ",", "."));

                        //Desativar exibição de DESCONTO nos PRODUTOS
                        $(".desconto").hide();

                        //Ativar exibição de DESCONTO APLICADO para o LOTE
                        $("#comDescontoSobreLoteAplicado").show();
                    }
                    else {
                        alert("ATENÇÃO!!!\n\nNão foi informado um VALOR PERCENTUAL de DESCONTO a ser aplicado.");

                        $("#PERCENTUAL_DESCONTO_ASER_APLICADO").focus();
                    }
                }
            });

            //Verifica se há valor digitado e faz os CÁLCULOS de TOTAIS, considerando os DESCONTOS setados, se houverem
            $('.calculaValor').blur(function (event) {
                //debugger;
                var id = "#" + $(this).attr('id');
                var identificador = id.replace("#inValorProduto_", "");
                var totalDoLote = "";

                var listaIdsProdutos = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array

                if (totalDoLote == "") {
                    totalDoLote = 0;
                }

                if ($(id).val() != "") {
                    //Verifica se há DESCONTOS setados
                    if ($("#APLICACAO_DO_DESCONTO").val() == 1) {
                        //SEM DESCONTO APLICADO

                        //Calcula o VALOR TOTAL por PRODUTO e ATUALIZA O VALOR DO LOTE
                        if (listaIdsProdutos.length > 0) {
                            for (var i = 0; i < listaIdsProdutos.length; i++) {
                                if (i > 0) {
                                    var totalCalculo = 0;
                                    var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                    var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                    var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                                    var multiplicador = "";

                                    if (document.getElementById(listaIdsProdutos[i]).checked == true) {
                                        if ($(valorRespondido).val() != "") {
                                            var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                            var multiplicando = new String($(valorRespondido).val());

                                            multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                            multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                            if ((totalDoLote != 0) && (totalDoLote != "")) {
                                                totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                            }

                                            totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                            //Atualiza campo de TOTAL sem o DESCONTO
                                            $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                            //Atualiza o valor TOTAL do LOTE (ADICIONANDO) sem o DESCONTO
                                            if (totalCalculo != "") {
                                                totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if ($("#APLICACAO_DO_DESCONTO").val() == 2) {
                        //DESCONTO APLICADO SOBRE CADA PRODUTO

                        if ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "") {
                            if (listaIdsProdutos.length > 0) {
                                for (var i = 0; i < listaIdsProdutos.length; i++) {
                                    if (i > 0) {
                                        var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                        var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                        var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                        var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                                        var valorASerAplicadoODesconto = $(valorRespondido).val().replace(".", "").replace(".", "").replace(",", ".");
                                        var valorDoDesconto = 0;
                                        var valorPosDesconto = 0;
                                        var totalCalculo = 0;
                                        var multiplicador = "";
                                        var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];

                                        if (document.getElementById(listaIdsProdutos[i]).checked == true) {
                                            //Calculando o DESCONTO
                                            valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                                            valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                                            //Calcula o VALOR TOTAL aplicado o DESCONTO
                                            var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                            var multiplicando = new String(valorPosDesconto);

                                            multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                            totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                            $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                            //Ativar exibição de DESCONTO APLICADO após valor do PRODUTO
                                            $(exibicaoDesconto).show();

                                            //Atualizar o TOTAL do LOTE, com os valores com DESCONTO
                                            if (parseFloat(totalDoLote) > 0) {
                                                totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                            }

                                            if (parseFloat(totalCalculo) > 0) {
                                                totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if ($("#APLICACAO_DO_DESCONTO").val() == 3) {
                        //DESCONTO APLICADO SOBRE O LOTE

                        //Atualizar campos dos PRODUTOS, anulando descontos aplicados em seus valores
                        if (($(valorRespondido).val() != "") || ($(valorRespondido).val() > 0)) {
                            if (listaIdsProdutos.length > 0) {
                                for (var i = 0; i < listaIdsProdutos.length; i++) {
                                    var totalCalculo = 0;
                                    var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                    var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                    var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                                    var multiplicador = "";

                                    if (i > 0) {
                                        if (document.getElementById(listaIdsProdutos[i]).checked == true) {
                                            //Calcula o VALOR TOTAL
                                            var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                            var multiplicando = new String($(valorRespondido).val());

                                            multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                            multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                            totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                            $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                            $(exibicaoDesconto).hide();

                                            //Atualizar o TOTAL do LOTE, com os valores com DESCONTO
                                            if (parseFloat(totalDoLote) > 0) {
                                                totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                            }

                                            if (parseFloat(totalCalculo) > 0) {
                                                totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                            }
                                        } else {
                                            //Coloca um valor zerado no campo
                                            $(campoRecebeResultado).val(moeda(totalCalculo, 0, ",", "."));
                                        }
                                    }
                                }
                            }
                        }

                        if ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "") {
                            var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                            var valorASerAplicadoODesconto = $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val().replace(".", "").replace(".", "").replace(",", ".");
                            var valorDoDesconto = 0;
                            var valorPosDesconto = 0;

                            //Calculando o DESCONTO
                            valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                            valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                            $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda(valorPosDesconto, 2, ",", "."));

                            //Desativar exibição de DESCONTO nos PRODUTOS
                            $(".desconto").hide();

                            //Ativar exibição de DESCONTO APLICADO para o LOTE
                            $("#comDescontoSobreLoteAplicado").show();
                        }
                    }
                }
                else {
                    //Verifica se há DESCONTOS setados
                    if ($("#APLICACAO_DO_DESCONTO").val() == 1) {
                        //SEM DESCONTO APLICADO

                        if (listaIdsProdutos.length > 0) {
                            for (var i = 0; i < listaIdsProdutos.length; i++) {
                                if (i > 0) {
                                    var totalCalculo = 0;
                                    var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                    var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                    var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                                    var multiplicador = "";

                                    if (document.getElementById(listaIdsProdutos[i]).checked == true) {
                                        var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                        var multiplicando = new String($(valorRespondido).val());

                                        multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                        multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                        if ((totalDoLote != 0) && (totalDoLote != "")) {
                                            totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                        }

                                        totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                        //Atualiza o valor TOTAL do LOTE (ADICIONANDO) sem o DESCONTO
                                        if (totalCalculo != "") {
                                            totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");
                                        }
                                    }
                                }
                            }

                            $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                        }
                    }
                    else if ($("#APLICACAO_DO_DESCONTO").val() == 2) {
                        //DESCONTO APLICADO SOBRE CADA PRODUTO

                        if ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "") {
                            if (listaIdsProdutos.length > 0) {
                                for (var i = 0; i < listaIdsProdutos.length; i++) {
                                    if (i > 0) {
                                        var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                        var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                        var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                        var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                                        var valorASerAplicadoODesconto = $(valorRespondido).val().replace(".", "").replace(".", "").replace(",", ".");
                                        var valorDoDesconto = 0;
                                        var valorPosDesconto = 0;
                                        var totalCalculo = 0;
                                        var multiplicador = "";
                                        var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];

                                        //Calculando o DESCONTO
                                        valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                                        valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                                        //Calcula o VALOR TOTAL aplicado o DESCONTO
                                        var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                        var multiplicando = new String(valorPosDesconto);

                                        multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                        totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                        $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                        //Ativar exibição de DESCONTO APLICADO após valor do PRODUTO
                                        $(exibicaoDesconto).show();

                                        //Atualizar o TOTAL do LOTE, com os valores com DESCONTO
                                        if (parseFloat(totalDoLote) > 0) {
                                            totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                        }

                                        if (parseFloat(totalCalculo) > 0) {
                                            totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                            $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if ($("#APLICACAO_DO_DESCONTO").val() == 3) {
                        //DESCONTO APLICADO SOBRE O LOTE

                        //Atualizar campos dos PRODUTOS, anulando descontos aplicados em seus valores
                        if (($(valorRespondido).val() != "") || ($(valorRespondido).val() > 0)) {
                            if (listaIdsProdutos.length > 0) {
                                for (var i = 0; i < listaIdsProdutos.length; i++) {
                                    var totalCalculo = 0;
                                    var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                    var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                    var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                                    var multiplicador = "";

                                    if (i > 0) {
                                        if (document.getElementById(listaIdsProdutos[i]).checked == true) {
                                            //Calcula o VALOR TOTAL
                                            var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                            var multiplicando = new String($(valorRespondido).val());

                                            multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                            multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                            totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                            $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                            $(exibicaoDesconto).hide();

                                            //Atualizar o TOTAL do LOTE, com os valores com DESCONTO
                                            if (parseFloat(totalDoLote) > 0) {
                                                totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                            }

                                            if (parseFloat(totalCalculo) > 0) {
                                                totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                            }
                                        } else {
                                            //Coloca um valor zerado no campo
                                            $(campoRecebeResultado).val(moeda(totalCalculo, 0, ",", "."));
                                        }
                                    }
                                }
                            }
                        }

                        if ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "") {
                            var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                            var valorASerAplicadoODesconto = $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val().replace(".", "").replace(".", "").replace(",", ".");
                            var valorDoDesconto = 0;
                            var valorPosDesconto = 0;

                            //Calculando o DESCONTO
                            valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                            valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                            $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda(valorPosDesconto, 2, ",", "."));

                            //Desativar exibição de DESCONTO nos PRODUTOS
                            $(".desconto").hide();

                            //Ativar exibição de DESCONTO APLICADO para o LOTE
                            $("#comDescontoSobreLoteAplicado").show();
                        }
                    }
                }

                //Desabilitar o DESCONTO
                if (listaIdsProdutos.length == 1) {
                    //Desativar exibição de DESCONTO nos PRODUTOS
                    $(".desconto").hide();

                    //Ativar exibição de DESCONTO APLICADO para o LOTE
                    $("#comDescontoSobreLoteAplicado").hide();

                    //NÃO APLICAR DESCONTO
                    $("#APLICACAO_DO_DESCONTO").val(1);
                    $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val('');

                    //Desmarca botões dos TIPOS de DESCONTO
                    $("#desconto1").attr("checked", true);
                    $("#desconto2").attr("checked", false);
                    $("#desconto3").attr("checked", false);
                }
            });

            //Calcula o valor total do PRODUTO da COTAÇÃO, ao responder a mesma e monta string de ID´s dos Produtos
            $(".check").click(function () {
                //debugger;
                var id = $(this).attr('id');
                var totalCalculo = 0;
                var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + id;
                var valorRespondido = "#inValorProduto_" + id;
                var campoRecebeResultado = "#inValorTotal_" + id;
                var exibicaoDesconto = "#comDescontoAplicado_" + id;
                var multiplicador = "";
                var totalDoLote = $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val();
                var valorDebitar = $(campoRecebeResultado).val();

                if (totalDoLote == "") {
                    totalDoLote = 0;
                }

                var listaIdsProdutos = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array

                if ((($(valorRespondido).val() != "") && ($(valorRespondido).val() != "0,00") && ($(valorRespondido).val() != "0.00")) || ($(valorRespondido).val() > 0)) {
                    if (document.getElementById(id).checked == true) {
                        //Calcula o VALOR TOTAL por PRODUTO
                        var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                        var multiplicando = new String($(valorRespondido).val());

                        multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                        multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                        if ((totalDoLote != 0) && (totalDoLote != "")) {
                            totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                        }

                        totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                        $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                        //Adiciona ID do PRODUTO selecionado ao stringão
                        listaIdsProdutos.push(id);
                        $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val(listaIdsProdutos);

                        //Se o DESCONTO tipos 2 ou 3 estiverem setados, exibe a inscrição pós campo com valor TOTAL por PRODUTO e APLICA o DESCONTO, conforme o local indicado pelo tipo
                        if (($("#APLICACAO_DO_DESCONTO").val() == 2) || ($("#APLICACAO_DO_DESCONTO").val() == 3)) {
                            if (($("#APLICACAO_DO_DESCONTO").val() == 2) && ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "")) {

                                //Calcula e aplica o tipo de DESCONTO SOBRE os PRODUTOS
                                var valorRespondido = "#inValorProduto_" + id;
                                var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + id;
                                var campoRecebeResultado = "#inValorTotal_" + id;
                                var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                                var valorASerAplicadoODesconto = $(valorRespondido).val().replace(".", "").replace(".", "").replace(",", ".");
                                var valorDoDesconto = 0;
                                var valorPosDesconto = 0;
                                var totalCalculo = 0;
                                var multiplicador = "";
                                var exibicaoDesconto = "#comDescontoAplicado_" + id;

                                //Calculando o DESCONTO
                                valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                                valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                                //Calcula o VALOR TOTAL aplicado o DESCONTO
                                var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                var multiplicando = new String(valorPosDesconto);

                                multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                $(exibicaoDesconto).show();

                                //Atualiza o  TOTAL do LOTE, aplicando o DESCONTO
                                if (totalCalculo != "") {
                                    totalDoLote = (parseFloat(totalDoLote) + parseFloat(totalCalculo));

                                    $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda(totalDoLote, 2, ",", "."));
                                }
                            }
                            else if (($("#APLICACAO_DO_DESCONTO").val() == 3) && ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "")) {
                                //Calcula e aplica o tipo de DESCONTO SOBRE os PRODUTOS
                                var totalLoteAgora = $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val().replace(".", "").replace(".", "").replace(",", ".");
                                var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                                var valorASerAplicadoODesconto = totalCalculo;
                                var valorDoDesconto = 0;
                                var valorPosDesconto = 0;

                                //Calculando o DESCONTO
                                valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                                valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));
                                totalLoteAgora = (parseFloat(totalLoteAgora) + parseFloat(valorPosDesconto))

                                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda((totalLoteAgora), 2, ",", "."));
                            }
                        }
                        else {
                            //Atualiza campo de TOTAL sem o DESCONTO
                            $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                            //Atualiza o valor TOTAL do LOTE (ADICIONANDO) sem o DESCONTO
                            if (totalCalculo != "") {
                                totalDoLote = (parseFloat(totalDoLote) + parseFloat(totalCalculo));

                                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda(totalDoLote, 2, ",", "."));
                            }
                        }
                    }
                    else {
                        $(valorRespondido).val('0,00'); //LIMPA e ZERA o VALOR RESPONDIDO

                        if (($("#APLICACAO_DO_DESCONTO").val() == 2) && ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "")) {
                            //Atualiza o valor TOTAL do LOTE (SUBTRAINDO)
                            if ($(campoRecebeResultado).val() != "") {
                                if ((totalDoLote != 0) && (totalDoLote != "")) {
                                    totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                }

                                valorDebitar = new String($(campoRecebeResultado).val());

                                valorDebitar = valorDebitar.replace(".", "").replace(".", "").replace(",", ".");
                                totalDoLote = (parseFloat(totalDoLote) - parseFloat(valorDebitar));

                                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda(totalDoLote, 2, ",", "."));

                                //Zera TOTAL do PRODUTO
                                $(campoRecebeResultado).val(moeda(0, 0, ",", "."));
                            }
                        } else if (($("#APLICACAO_DO_DESCONTO").val() == 3) && ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "")) {
                            if (listaIdsProdutos.length > 0) {
                                for (var i = 0; i < listaIdsProdutos.length; i++) {
                                    var totalCalculo = 0;
                                    var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                    var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                    var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                    var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                                    var multiplicador = "";
                                    var totalLoteAgora = $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val().replace(".", "").replace(".", "").replace(",", ".");

                                    if (i > 0) {
                                        if (document.getElementById(listaIdsProdutos[i]).checked == false) {
                                            $(campoRecebeResultado).val(moeda(totalCalculo, 0, ",", "."));

                                            //Calcula o valor que será debitado do LOTE
                                            var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                            var multiplicando = new String($(valorRespondido).val());

                                            multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                            multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                            totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                            var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                                            var valorASerAplicadoODesconto = totalCalculo;
                                            var valorDoDesconto = 0;
                                            var valorPosDesconto = 0;

                                            //Calculando o DESCONTO
                                            valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                                            valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                                            $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda((totalLoteAgora - valorPosDesconto), 2, ",", "."));

                                            //Zera TOTAL do PRODUTO
                                            $(campoRecebeResultado).val(moeda(0, 0, ",", "."));
                                        }
                                    }
                                }
                            }
                        }
                        else {
                            //Limpar campo de TOTAL do PRODUTO e acertar o valor TOTAL do LOTE
                            if (($(valorRespondido).val() != "") || ($(valorRespondido).val() > 0)) {
                                //Calcula o VALOR TOTAL por PRODUTO
                                var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                var multiplicando = new String($(valorRespondido).val());

                                multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                if ((totalDoLote != 0) && (totalDoLote != "")) {
                                    totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                }

                                totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                //Zera TOTAL do PRODUTO
                                $(campoRecebeResultado).val(moeda(0, 0, ",", "."));

                                //Atualiza o TOTAL do LOTE, aplicando o DESCONTO do valor desmarcado
                                if (totalCalculo != "") {
                                    totalDoLote = (parseFloat(totalDoLote) - parseFloat(totalCalculo));

                                    $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda(totalDoLote, 2, ",", "."));
                                }
                            }
                        }

                        //Excluir ID do PRODUTO do stringão
                        var indexProduto = listaIdsProdutos.indexOf(id);

                        listaIdsProdutos.splice(indexProduto, 1);
                        $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val(listaIdsProdutos);

                        //Desativar exibição de DESCONTO APLICADO no valor do PRODUTO
                        $(exibicaoDesconto).hide();
                    }

                    //Exibe opção de INSERIR PERCENTUAL de DESCONTO e APLICAR DESCONTOS se houver algum PRODUTO marcado para COTAÇÃO
                    if ($("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val() != "") {
                        $("#percentualDesconto").show("slow");
                    }
                    else {
                        $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val('');  //Limpar campo de PERCENTUAL de DESCONTO

                        //Desmarca o DESCONTO e seta NÃO APLICAR DESCONTO
                        if ((document.getElementById("desconto2").checked == true) || ((document.getElementById("desconto3").checked == true))) {
                            $("#desconto1").attr("checked", true);
                            $("#desconto2").attr("checked", false);
                            $("#desconto3").attr("checked", false);

                            $("#APLICACAO_DO_DESCONTO").val(1);
                        }

                        $("#percentualDesconto").hide("slow");
                        $("#aplicarDescontos").hide("slow");

                        $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val('');
                        $("#comDescontoSobreLoteAplicado").hide();
                    }
                }
                else {
                    alert('ATENÇÃO!\n\nVocê só pode confirmar a COTAÇÃO de um produto, após preecher um valor para o mesmo.');

                    $('#' + id).prop('checked', false);
                    $(valorRespondido).focus();
                }

                //Desabilitar exibições de DESCONTO
                if (listaIdsProdutos.length == 1) {
                    //Desativar exibição de DESCONTO nos PRODUTOS
                    $(".desconto").hide();

                    //Ativar exibição de DESCONTO APLICADO para o LOTE
                    $("#comDescontoSobreLoteAplicado").hide();
                }
            });

            //Só permite números em campos com esta classe implementada
            $('.sonums').keypress(function (event) {
                var tecla = (window.event) ? event.keyCode : event.which;
                if ((tecla > 47 && tecla < 58)) return true;
                else {
                    if (tecla != 8)
                        return false;
                    else
                        return true;
                }
            });

            //Atualiza os valores TOTAIS, de acordo com o TIPO de DESCONTO setado
            $("#PERCENTUAL_DESCONTO_ASER_APLICADO").blur(function () {
                var listaIdsProdutos = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array
                var totalDoLote = "";

                if (($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "") && ($("#APLICACAO_DO_DESCONTO").val() != "")) {
                    if (listaIdsProdutos.length > 0) {
                        for (var i = 0; i < listaIdsProdutos.length; i++) {
                            //Declarar e inicializar variáveis que serão usadas para a atualização
                            var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                            var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                            var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                            var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                            var multiplicador = "";
                            var totalCalculo = 0;

                            //Atualiza a variável, se ela não possui valor
                            if (totalDoLote == "") {
                                totalDoLote = 0;
                            }

                            //Atualiza o campo TOTAL em cada PRODUTO
                            if (i > 0) {
                                if (document.getElementById(listaIdsProdutos[i]).checked == true) {
                                    if (($(valorRespondido).val() != "") || ($(valorRespondido).val() > 0)) {
                                        //Calcula o VALOR TOTAL
                                        var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                        var multiplicando = new String($(valorRespondido).val());

                                        multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                        multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                        totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                        //Se o DESCONTO tipos 2 ou 3 estiverem setados, exibe a inscrição pós campo com valor TOTAL por PRODUTO e APLICA o DESCONTO, conforme o local indicado pelo tipo
                                        if (($("#APLICACAO_DO_DESCONTO").val() == 2) || ($("#APLICACAO_DO_DESCONTO").val() == 3)) {
                                            if (($("#APLICACAO_DO_DESCONTO").val() == 2) && ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "")) {

                                                //Calcula e aplica o tipo de DESCONTO SOBRE os PRODUTOS
                                                var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                                var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                                var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                                var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                                                var valorASerAplicadoODesconto = $(valorRespondido).val().replace(".", "").replace(".", "").replace(",", ".");
                                                var valorDoDesconto = 0;
                                                var valorPosDesconto = 0;
                                                var totalCalculo = 0;
                                                var multiplicador = "";
                                                var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];

                                                //Calculando o DESCONTO
                                                valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                                                valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                                                //Calcula o VALOR TOTAL aplicado o DESCONTO
                                                var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                                var multiplicando = new String(valorPosDesconto);

                                                multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                                totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                                $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                                $(exibicaoDesconto).show();

                                                //Atualiza o  TOTAL do LOTE, aplicando o DESCONTO
                                                if ((totalDoLote != 0) && (totalDoLote != "")) {
                                                    totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                                }

                                                if (totalCalculo != "") {
                                                    totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                                    $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                                }
                                            }
                                            else if (($("#APLICACAO_DO_DESCONTO").val() == 3) && ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "")) {
                                                //Atualizar campos dos PRODUTOS, anulando descontos aplicados em seus valores
                                                if (($(valorRespondido).val() != "") || ($(valorRespondido).val() > 0)) {
                                                    if (listaIdsProdutos.length > 0) {
                                                        for (var i = 0; i < listaIdsProdutos.length; i++) {
                                                            var totalCalculo = 0;
                                                            var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                                                            var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                                                            var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                                                            var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                                                            var multiplicador = "";

                                                            if (i > 0) {
                                                                if (document.getElementById(listaIdsProdutos[i]).checked == true) {
                                                                    //Calcula o VALOR TOTAL
                                                                    var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                                                    var multiplicando = new String($(valorRespondido).val());

                                                                    multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                                                    multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                                                    totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                                                    $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                                                    $(exibicaoDesconto).hide();

                                                                    //Atualizar o TOTAL do LOTE, com os valores com DESCONTO
                                                                    if (parseFloat(totalDoLote) > 0) {
                                                                        totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                                                    }

                                                                    if (parseFloat(totalCalculo) > 0) {
                                                                        totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                                                        $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);
                                                                    }
                                                                } else {
                                                                    //Coloca um valor zerado no campo
                                                                    $(campoRecebeResultado).val(moeda(totalCalculo, 0, ",", "."));
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                                if ($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val() != "") {
                                                    var percentualDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val().replace(",", ".");
                                                    var valorASerAplicadoODesconto = $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val().replace(".", "").replace(".", "").replace(",", ".");
                                                    var valorDoDesconto = 0;
                                                    var valorPosDesconto = 0;

                                                    //Calculando o DESCONTO
                                                    valorDoDesconto = ((parseFloat(percentualDesconto) * parseFloat(valorASerAplicadoODesconto)) / 100);
                                                    valorPosDesconto = (parseFloat(valorASerAplicadoODesconto) - parseFloat(valorDoDesconto));

                                                    $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda(valorPosDesconto, 2, ",", "."));

                                                    //Desativar exibição de DESCONTO nos PRODUTOS
                                                    $(".desconto").hide();

                                                    //Ativar exibição de DESCONTO APLICADO para o LOTE
                                                    $("#comDescontoSobreLoteAplicado").show();
                                                }
                                            }
                                        }
                                        else {
                                            //Atualiza campo de TOTAL sem o DESCONTO
                                            $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));
                                        }
                                    }
                                }
                            }
                        }

                        //Exibe os botões de rádio com as opções de aplicação de DESCONTO
                        $("#aplicarDescontos").show("slow");
                    }
                }
                else {
                    if (listaIdsProdutos.length > 0) {
                        for (var i = 0; i < listaIdsProdutos.length; i++) {
                            //Declarar e inicializar variáveis que serão usadas para a atualização
                            var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + listaIdsProdutos[i];
                            var valorRespondido = "#inValorProduto_" + listaIdsProdutos[i];
                            var campoRecebeResultado = "#inValorTotal_" + listaIdsProdutos[i];
                            var exibicaoDesconto = "#comDescontoAplicado_" + listaIdsProdutos[i];
                            var multiplicador = "";
                            var totalCalculo = 0;

                            //Atualiza a variável, se ela não possui valor
                            if (totalDoLote == "") {
                                totalDoLote = 0;
                            }

                            if (i > 0) {
                                if (($(valorRespondido).val() != "") || ($(valorRespondido).val() > 0)) {
                                    //Calcula o VALOR TOTAL
                                    var campoQuantidadeReal = new String($(nomeCampoQuantidade).val());
                                    var multiplicando = new String($(valorRespondido).val());

                                    multiplicando = multiplicando.replace(".", "").replace(".", "").replace(",", ".");
                                    multiplicador = campoQuantidadeReal.replace(".", "").replace(".", "").replace(",", ".");

                                    totalCalculo = (parseFloat(multiplicador) * parseFloat(multiplicando));

                                    $(campoRecebeResultado).val(moeda(totalCalculo, 2, ",", "."));

                                    //Atualiza o  TOTAL do LOTE, desaplicando o DESCONTO
                                    if ((totalDoLote != 0) && (totalDoLote != "")) {
                                        totalDoLote = totalDoLote.replace(".", "").replace(".", "").replace(",", ".");
                                    }

                                    if (totalCalculo != "") {
                                        totalDoLote = moeda((parseFloat(totalDoLote) + parseFloat(totalCalculo)), 2, ",", ".");

                                        $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(totalDoLote);

                                        //Desativar exibição de DESCONTO APLICADO para o LOTE
                                        $("#comDescontoSobreLoteAplicado").hide();
                                    }
                                }
                            }
                        }
                    }
                }
            });

            //Botão RESPONDER COTAÇÃO
            $(document).on("click", "#responderACotacao", function () {
                //debugger;
                var idsProdutosSelecionadosParaRespostaDaCotacao = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array
                var valoresUnitariosInformadosDosProdutosSelecionadosParaRespostaDaCotacao = $('#VALORES_UNITARIOS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DACOTACAO').val().split(',');
                var quantidadeSolicitada;
                var calculandoValorInteiroSemDesconto;
                var valorRespondidoCalculo;
                var totalDosProdutosSemDesconto = parseFloat(0);
                var tipoDeDesconto = 1;
                var percentualDeDesconto = 0;
                var campoAlerta = "ATENÇÃO!!\n\nO(s) campo(s) abaixo deve(m) estar preenchido(s):\n\n";
                var camposASeremPreenchidos = "";

                //Calcular o VALOR TOTAL da cotação SEM DESCONTO.
                for (var i = 0; i < idsProdutosSelecionadosParaRespostaDaCotacao.length; i++) {
                    if (idsProdutosSelecionadosParaRespostaDaCotacao[i] != "") {
                        var valorRespondido = "#inValorProduto_" + idsProdutosSelecionadosParaRespostaDaCotacao[i];
                        var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + idsProdutosSelecionadosParaRespostaDaCotacao[i];

                        // Calcula o TOTAL da soma dos valores da COTAÇÂO, SEM DESCONTO APLICADO
                        quantidadeSolicitada = $(nomeCampoQuantidade).val().replace('.', '').replace(',', '.');
                        valorRespondidoCalculo = $(valorRespondido).val().replace('.', '').replace(',', '.');
                        calculandoValorInteiroSemDesconto = (parseFloat(quantidadeSolicitada) * parseFloat(valorRespondidoCalculo));
                        totalDosProdutosSemDesconto = (parseFloat(totalDosProdutosSemDesconto) + (parseFloat(calculandoValorInteiroSemDesconto)));

                        valoresUnitariosInformadosDosProdutosSelecionadosParaRespostaDaCotacao.push($(valorRespondido).val().replace('.', '').replace(',', '.'));
                    }
                }

                //Atribuir valores às variáveis correlatas
                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR_SEM_DESCONTO").val(totalDosProdutosSemDesconto);
                $("#VALORES_UNITARIOS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DACOTACAO").val(valoresUnitariosInformadosDosProdutosSelecionadosParaRespostaDaCotacao);

                if (parseFloat($("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR_SEM_DESCONTO").val()) > 0) {
                    if (($("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").val() != "") && ($("#ID_TIPO_DE_FRETE").val() > 0)) {
                        //Confirma com o USUÁRIO que está respondendo a cotação do USUÁRIO COTANTE se o mesmo deseja que a resposta seja registrada
                        var confirmaRespostaDaCotacaoSimOuNao = confirm("ATENÇÃO!!\n\nAconselhamos que sejam revisados os valores respondidos para os PRODUTOS ou SERVIÇOS solicitados nesta cotação, afim de evitar respostas erradas para os mesmos!\n\nSe os valores estão corretos, deseja CONFIRMAR a resposta para esta cotação?");

                        if (confirmaRespostaDaCotacaoSimOuNao) {
                            //RESPONDE finalmente a COTAÇÃO
                            if ($("#APLICACAO_DO_DESCONTO").val() != "") {
                                tipoDeDesconto = $("#APLICACAO_DO_DESCONTO").val();
                            }

                            if (parseFloat($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val()) > 0) {
                                percentualDeDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val();
                            }

                            //Tentando o ajax pra fazer o POST do formulário
                            $.ajax({
                                url: "/UsuarioEmpresa/EnviarARespostaDaCotacao",
                                dataType: 'json',
                                cache: false,
                                async: true,
                                data: {
                                    'idCotacaoMaster': $("#ID_COTACAO_MASTER").val(),
                                    'idCotacaoFilha': $("#ID_COTACAO_FILHA").val(),
                                    'idsProdutosSelecionadosResposta': $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val(),
                                    'valoresUnitariosRespostaDaCotacao': $("#VALORES_UNITARIOS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DACOTACAO").val(),
                                    'valorTotalDoLoteSemDesconto': $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR_SEM_DESCONTO").val(),
                                    'formaDePagamento': $("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").val(),
                                    'tipoDeFrete': $("#ID_TIPO_DE_FRETE").val(),
                                    'tipoDeDesconto': tipoDeDesconto,
                                    'percentualDeDesconto': percentualDeDesconto,
                                    'observacao': $("#OBSERVACAO_COTACAO_USUARIO_COTANTE").val(),
                                    'tipoDaResposta': $("#TIPO_COTACAO_RECEBIDA").val()
                                },
                                success: function (result) {
                                    if (result.itemRespondido == "ok") {
                                        //Desabilita campos digitáveis, pós RESPOSTA da COTAÇÃO
                                        $(".valorResposta").attr("disabled", true);
                                        $(".check").attr("disabled", true);
                                        $("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").attr("disabled", true);
                                        $("#ID_TIPO_DE_FRETE").attr("disabled", true);
                                        $("#PERCENTUAL_DESCONTO_ASER_APLICADO").attr("disabled", true);
                                        $(".radio0").attr("disabled", true);
                                        $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").attr("disabled", true);
                                        $(".imagemProduto").bind('click', false); //Desabilita os links
                                        //$('.imagemProduto').unbind('click', false); //Re-habilita os links

                                        $('#responderACotacao').attr("disabled", true); //Desabilita o botão de RESPOSTA de COTAÇÃO

                                        var redirecionaSimOuNao = confirm("ATENÇÃO!!\n\nA COTAÇÃO foi respondida com sucesso!\n\nSua resposta será comunicada ao USUÁRIO que lhe enviou a COTAÇÃO.\n\nPosso redirecioná-lo para a tela de LISTAGEM das COTAÇÕES?");

                                        if (redirecionaSimOuNao) {
                                            window.location = $('#irParaOInicio').attr('href'); //Redireciona para a LISTAGEM das COTAÇÕES
                                        }
                                        else
                                        {
                                            $('#responderACotacao').hide(); //Esconde o botão de ENVIAR COTAÇÃO
                                        }
                                    } else {
                                        alert('ATENÇÃO!!\n\nA RESPOSTA da COTAÇÃO nao pôde ser enviada agora.\n\nPor favor, tente mais tarde.');
                                    }
                                }
                            });
                        }
                    }
                    else {
                        //Checa campo 'FORMA DE PGTO:'
                        if ($("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").val() == "") {
                            camposASeremPreenchidos = " - FORMA DE PGTO;\n";
                        }

                        //Checa campo 'TIPO DE FRETE:'
                        if ($("#ID_TIPO_DE_FRETE").val() == 0) {
                            if (camposASeremPreenchidos == "") {
                                camposASeremPreenchidos = " - TIPO DE FRETE;";
                            }
                            else {
                                camposASeremPreenchidos = camposASeremPreenchidos + " - TIPO DE FRETE;";
                            }
                        }

                        alert(campoAlerta + camposASeremPreenchidos);

                        //Seta o foco em um dos campos
                        if ($("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").val() == "") {
                            $("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").focus();
                        }
                        else if ($("#ID_TIPO_DE_FRETE").val() == 0) {
                            $("#ID_TIPO_DE_FRETE").focus();
                        }
                    }
                }
                else {
                    alert('ATENÇÃO!!\n\nA COTAÇÃO só pode ser respondida depois que pelo menos 01 dos produtos tiver o VALOR UNITÁRIO informado.');
                }
            });

            //Botão EDITAR COTAÇÃO
            $(document).on("click", "#editarACotacao", function () {
                var idsProdutosSelecionadosParaRespostaDaCotacao = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array
                var valoresUnitariosInformadosDosProdutosSelecionadosParaRespostaDaCotacao = [];
                var quantidadeSolicitada;
                var calculandoValorInteiroSemDesconto;
                var valorRespondidoCalculo;
                var totalDosProdutosSemDesconto = parseFloat(0);
                var tipoDeDesconto = 0;
                var percentualDeDesconto = 0;
                var campoAlerta = "ATENÇÃO!!\n\nO(s) campo(s) abaixo deve(m) estar preenchido(s):\n\n";
                var camposASeremPreenchidos = "";

                //Calcular o VALOR TOTAL da cotação SEM DESCONTO.
                debugger;
                for (var i = 0; i < idsProdutosSelecionadosParaRespostaDaCotacao.length; i++) {
                    if (idsProdutosSelecionadosParaRespostaDaCotacao[i] != "") {
                        var valorRespondido = "#inValorProduto_" + idsProdutosSelecionadosParaRespostaDaCotacao[i];
                        var nomeCampoQuantidade = "#inQuantidadeRealDoProduto_" + idsProdutosSelecionadosParaRespostaDaCotacao[i];

                        // Calcula o TOTAL da soma dos valores da COTAÇÂO, SEM DESCONTO APLICADO
                        quantidadeSolicitada = $(nomeCampoQuantidade).val().replace('.', '').replace(',', '.');
                        valorRespondidoCalculo = $(valorRespondido).val().replace('.', '').replace(',', '.');
                        calculandoValorInteiroSemDesconto = (parseFloat(quantidadeSolicitada) * parseFloat(valorRespondidoCalculo));
                        totalDosProdutosSemDesconto = (parseFloat(totalDosProdutosSemDesconto) + (parseFloat(calculandoValorInteiroSemDesconto)));

                        valoresUnitariosInformadosDosProdutosSelecionadosParaRespostaDaCotacao.push($(valorRespondido).val().replace('.', '').replace(',', '.'));
                    }
                }

                //Atribuir valores às variáveis correlatas
                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR_SEM_DESCONTO").val(totalDosProdutosSemDesconto);
                $("#VALORES_UNITARIOS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DACOTACAO").val(valoresUnitariosInformadosDosProdutosSelecionadosParaRespostaDaCotacao);

                if (parseFloat($("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR_SEM_DESCONTO").val()) > 0) {
                    if (($("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").val() != "") && ($("#ID_TIPO_DE_FRETE").val() > 0)) {

                        //Confirma com o USUÁRIO que está respondendo a cotação do USUÁRIO COTANTE se o mesmo deseja que a resposta seja registrada
                        var confirmaRespostaDaCotacaoSimOuNao = confirm("ATENÇÃO!!\n\nAconselhamos que sejam revisados os valores respondidos para os PRODUTOS ou SERVIÇOS solicitados nesta cotação, afim de evitar respostas erradas para os mesmos!\n\nSe os valores estão corretos, deseja CONFIRMAR a resposta para esta cotação?");

                        if (confirmaRespostaDaCotacaoSimOuNao) {
                            //RESPONDE finalmente a COTAÇÃO
                            if ($("#APLICACAO_DO_DESCONTO").val() != "") {
                                tipoDeDesconto = $("#APLICACAO_DO_DESCONTO").val();
                            }

                            if (parseFloat($("#PERCENTUAL_DESCONTO_ASER_APLICADO").val()) > 0) {
                                percentualDeDesconto = $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val();
                            }

                            //Ajax pra fazer o POST do formulário
                            $.ajax({
                                url: "/UsuarioEmpresa/EditarARespostaDaCotacao",
                                dataType: 'json',
                                cache: false,
                                async: true,
                                data: {
                                    'idCotacaoMaster': $("#ID_COTACAO_MASTER").val(),
                                    'idCotacaoFilha': $("#ID_COTACAO_FILHA").val(),
                                    'idsProdutosSelecionadosResposta': $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val(),
                                    'valoresUnitariosRespostaDaCotacao': $("#VALORES_UNITARIOS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DACOTACAO").val(),
                                    'valorTotalDoLoteSemDesconto': $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR_SEM_DESCONTO").val(),
                                    'formaDePagamento': $("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").val(),
                                    'tipoDeFrete': $("#ID_TIPO_DE_FRETE").val(),
                                    'tipoDeDesconto': tipoDeDesconto,
                                    'percentualDeDesconto': percentualDeDesconto,
                                    'observacao': $("#OBSERVACAO_COTACAO_USUARIO_COTANTE").val(),
                                    'tipoDaResposta': $("#TIPO_COTACAO_RECEBIDA").val()
                                },
                                success: function (result) {
                                    if (result.itemRespondido == "ok") {
                                        //Desabilita campos digitáveis, pós RESPOSTA da COTAÇÃO
                                        $(".valorResposta").attr("disabled", true);
                                        $(".check").attr("disabled", true);
                                        $("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").attr("disabled", true);
                                        $("#ID_TIPO_DE_FRETE").attr("disabled", true);
                                        $("#PERCENTUAL_DESCONTO_ASER_APLICADO").attr("disabled", true);
                                        $(".radio0").attr("disabled", true);
                                        $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").attr("disabled", true);
                                        $(".imagemProduto").bind('click', false); //Desabilita os links

                                        $('#responderACotacao').attr("disabled", true); //Desabilita o botão de RESPOSTA de COTAÇÃO

                                        var redirecionaSimOuNao = confirm("ATENÇÃO!!\n\nA COTAÇÃO foi alterada com sucesso!\n\nSua nova resposta será visualizada e considerada pelo USUÁRIO que lhe enviou a COTAÇÃO.\n\nPosso redirecioná-lo para a tela de LISTAGEM das COTAÇÕES?");

                                        if (redirecionaSimOuNao) {
                                            window.location = $('#irParaOInicio').attr('href'); //Redireciona para a LISTAGEM das COTAÇÕES
                                        }
                                        else
                                        {
                                            $('#editarACotacao').hide(); //Esconde o botão de EDIÇÃO da COTAÇÃO
                                        }
                                    } else {
                                        alert('ATENÇÃO!!\n\nA alteração da RESPOSTA da COTAÇÃO nao pôde ser enviada agora.\n\nPor favor, tente mais tarde.');
                                    }
                                }
                            });
                        }
                    }
                    else {
                        //Checa campo 'FORMA DE PGTO:'
                        if ($("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").val() == "") {
                            camposASeremPreenchidos = " - FORMA DE PGTO;\n";
                        }

                        //Checa campo 'TIPO DE FRETE:'
                        if ($("#ID_TIPO_DE_FRETE").val() == 0) {
                            if (camposASeremPreenchidos == "") {
                                camposASeremPreenchidos = " - TIPO DE FRETE;";
                            }
                            else {
                                camposASeremPreenchidos = camposASeremPreenchidos + " - TIPO DE FRETE;";
                            }
                        }

                        alert(campoAlerta + camposASeremPreenchidos);

                        //Seta o foco em um dos campos
                        if ($("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").val() == "") {
                            $("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").focus();
                        }
                        else if ($("#ID_TIPO_DE_FRETE").val() == 0) {
                            $("#ID_TIPO_DE_FRETE").focus();
                        }
                    }
                }
                else {
                    alert('ATENÇÃO!!\n\nA COTAÇÃO só pode ser respondida depois que pelo menos 01 dos produtos tiver o VALOR UNITÁRIO informado.');
                }
            });

            //Adiciona IMAGEM do PRODUTO ALTERNATIVO por quadro (estilo Facebook)
            $(".prod_alter").click(function () {
                $("#ID_QUADRO_FOTOS").val($(this).attr('id'));

                $("#fileupload").click();
            });

            //Excluir a IMAGEM do PRODUTO ALTERNATIVO por quadro
            $(".excluir_prod_alter").click(function () {

                if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA')
                {
                    var campoExclusao = "#";
                    var quadroExclusao = "";
                    var iconeExclusao = "";
                    var caminhoImagem = "";
                    var nomeImagem = "";

                    if ($("#TIPO_IMAGEM_EXCLUSAO").val() == "inc") {
                        //Prepara a EXCLUSÃO das imagens no momento de ADICIONAR
                        campoExclusao = (campoExclusao + "inIdFoto_" + $(this).attr('id').replace('excluir_inc_imagem_link_', ''));
                        quadroExclusao = ("#imagem_" + $(this).attr('id').replace('excluir_inc_imagem_link_', ''));
                        iconeExclusao = ("#excluir_imagem_" + $(this).attr('id').replace('excluir_inc_imagem_link_', ''));

                        nomeImagem = $('#imagem_' + $(this).attr('id').replace('excluir_inc_imagem_link_', '')).attr("src");
                        caminhoImagem = ("" + "/" + $("#ID_EMPRESA").val() + "/" + $("#ID_USUARIO").val() + "/");
                        nomeImagem = nomeImagem.replace('/Content/imagensProdutosAlternativos' + caminhoImagem, '');
                    }
                    else if ($("#TIPO_IMAGEM_EXCLUSAO").val() == "ver") {
                        //Prepara a EXCLUSÃO das imagens no momento da EXIBIR
                        campoExclusao = (campoExclusao + "inIdVer_Foto_" + $(this).attr('id').replace('excluir_ver_imagem_link_', ''));
                        quadroExclusao = ("#imagem_" + $(this).attr('id').replace('excluir_ver_imagem_link_', '') + "_ver");
                        iconeExclusao = ("#ver_excluir_imagem_" + $(this).attr('id').replace('excluir_ver_imagem_link_', ''));

                        nomeImagem = $('#imagem_' + $(this).attr('id').replace('excluir_ver_imagem_link_', '') + "_ver").attr("src");
                        caminhoImagem = ("" + "/" + $("#ID_EMPRESA").val() + "/" + $("#ID_USUARIO").val() + "/");
                        nomeImagem = nomeImagem.replace('/Content/imagensProdutosAlternativos' + caminhoImagem, '');
                    }

                    if (campoExclusao != "") {
                        $.ajax({
                            url: "/UsuarioEmpresa/ExcluirImagemProdutoAlternativo",
                            dataType: 'json',
                            cache: false,
                            async: true,
                            data: {
                                'idImagemPRodutoAlternativo': $(campoExclusao).val(), 'nomeDaImagem': nomeImagem, 'tipoCotacao': $("#TIPO_COTACAO_RECEBIDA").val()
                            },
                            success: function (result) {
                                //debugger;
                                if (result.itemExcluido == "ok") {
                                    //Limpa a imagem do quadro
                                    $(quadroExclusao).attr("src", "");
                                    $(quadroExclusao).css('opacity', 1);

                                    //Desabilitando ícone de EXCLUSÃO das imagens dos quadros
                                    $(iconeExclusao).hide();

                                    //Limpa a variável, preparando para o próximo produto a receber fotos
                                    $("#ID_QUADRO_FOTOS").val("");
                                }
                            }
                        });
                    }
                }
            });

            //Excluir TODAS as IMAGENS do PRODUTO ALTERNATIVO por quadro
            $(".excluir_todas_prod_alter").click(function () {

                if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                    $.ajax({
                        url: "/UsuarioEmpresa/ExcluirTodasAsImagensProdutoAlternativo",
                        dataType: 'json',
                        cache: false,
                        async: true,
                        data: {
                            'idProdutoCotacao': $("#ID_PRODUTO_FOTOS").val(), 'listaDeNomesDasImagens': "", 'tipoCotacao': $("#TIPO_COTACAO_RECEBIDA").val()
                        },
                        success: function (result) {
                            if (result.itensExcluidos == "ok") {
                                if ($("#TIPO_IMAGEM_EXCLUSAO").val() == "inc") {
                                    //Limpa as IMAGENS dos quadro
                                    for (var i = 0; i <= 5; i++) {
                                        var quadro_imagem = "#imagem_" + i;

                                        $(quadro_imagem).attr("src", "");
                                        $(quadro_imagem).css('opacity', 1);
                                    }

                                    //Desliga o botão de CONFIRMAR FOTOS anexadas
                                    $("#confirmarFotos").hide();

                                    //Desabilitando ícone de EXCLUSÃO das imagens dos quadros
                                    $("#excluir_imagem_1").hide();
                                    $("#excluir_imagem_2").hide();
                                    $("#excluir_imagem_3").hide();
                                    $("#excluir_imagem_4").hide();
                                    $("#excluir_imagem_5").hide();

                                    $("#excluir_todas_inc").hide();
                                }
                                else if ($("#TIPO_IMAGEM_EXCLUSAO").val() == "ver") {
                                    //Limpa as IMAGENS dos quadro
                                    for (var i = 0; i <= 5; i++) {
                                        var quadro_imagem = "#imagem_" + i + "_ver";

                                        $(quadro_imagem).attr("src", "");
                                        $(quadro_imagem).css('opacity', 1);
                                    }

                                    //Desabilitando ícone de EXCLUSÃO das imagens dos quadros
                                    $("#ver_excluir_imagem_1").hide();
                                    $("#ver_excluir_imagem_2").hide();
                                    $("#ver_excluir_imagem_3").hide();
                                    $("#ver_excluir_imagem_4").hide();
                                    $("#ver_excluir_imagem_5").hide();

                                    $("#excluir_todas_ver").hide();
                                }

                                //Limpa a variável, preparando para o próximo produto a receber fotos
                                //$("#ID_PRODUTO_FOTOS").val("");
                                $("#ID_QUADRO_FOTOS").val("");
                                $("#TIPO_IMAGEM_EXCLUSAO").val("");
                            }
                        }
                    });
                }
            });

            //UPLOAD de arquivos
            $('#fileupload').fileupload({
                dataType: 'json',
                url: '/UsuarioEmpresa/UploadFiles',
                autoUpload: true,
                done: function (e, data) {
                    //Gravar nome da IMAGEM na tabela do banco
                    //debugger;
                    if ((data.result.name != "") && (data.result.imagemAceita == "ok")) {
                        $.ajax({
                            url: "/UsuarioEmpresa/GravarImagemProdutoAlternativo",
                            dataType: 'json',
                            cache: false,
                            async: true,
                            data: {
                                'idProdutoCotacao': $("#ID_PRODUTO_FOTOS").val(), 'nomeDaImagem': data.result.name, 'tipoCotacao': $("#TIPO_COTACAO_RECEBIDA").val()
                            },
                            success: function (result) {
                                //debugger;
                                if (result.itemGravado == "ok")
                                {
                                    //Exibir a imagem no quadro, já devidamente gravada
                                    var quadro_imagem = "#" + $("#ID_QUADRO_FOTOS").val().replace('link_', '');

                                    $(quadro_imagem).attr("src", data.result.caminhoImg);
                                    $(quadro_imagem).css('opacity', 1);

                                    //Exibe as opções de EXCLUSÃO das IMAGENS
                                    if (quadro_imagem == "#imagem_1") {
                                        $("#inIdFoto_1").val(result.idDaImagemProduto);

                                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                                            $("#excluir_imagem_1").show();
                                        }
                                    } else if (quadro_imagem == "#imagem_2") {
                                        $("#inIdFoto_2").val(result.idDaImagemProduto);

                                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                                            $("#excluir_imagem_2").show();
                                        }
                                    } else if (quadro_imagem == "#imagem_3") {
                                        $("#inIdFoto_3").val(result.idDaImagemProduto);

                                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                                            $("#excluir_imagem_3").show();
                                        }
                                    } else if (quadro_imagem == "#imagem_4") {
                                        $("#inIdFoto_4").val(result.idDaImagemProduto);

                                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                                            $("#excluir_imagem_4").show();
                                        }
                                    } else if (quadro_imagem == "#imagem_5") {
                                        $("#inIdFoto_5").val(result.idDaImagemProduto);

                                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                                            $("#excluir_imagem_5").show();
                                        }
                                    }

                                    if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                                        //Exibe o botão de CONFIRMAR FOTOS anexadas
                                        $("#confirmarFotos").show();
                                    }
                                }
                            }
                        });
                    }
                    else {
                        alert('ATENÇÃO!\n\nA IMAGEM selecionada deve ser do tipo JPG ou PNG');
                    }

                    //Após UPLOAD, desliga barra de progresso
                    var intervalo = 0;

                    clearInterval(intervalo);//ou clearTimeout()
                    intervalo = window.setTimeout(DesligaBarra, 1000);
                }
            }).on('fileuploadprogressall', function (e, data) {
                $('#barra_progresso').show(); //Exibe barra

                var progress = parseInt(data.loaded / data.total * 100, 10);
                $('.progress .progress-bar').css('width', progress + '%');
            });

            //Ao FECHAR POPUP de INCLUSÃO de IMAGENS
            $("#fecharPopUpImagens").click(function () {
                //debugger;
                var nomeImagem = "";
                var quantasImagens = 0;

                $("#BOTAO_CONFIRMAR_FOTOS").val(0); //Reinicializa variável de controle da ação de FECHAR POPUP
                $("#QUANTIDADE_FOTOS_NOPRODUTO").val(0); //Reinicializa a variável de quantidade de fotos
                $("#excluir_todas_inc").hide(); //Esconder link EXCLUIR TODAS

                //Apurar quantidade de IMAGENS inseridas, esconder ícones de EXCLUSÃO individual e limpar QUADROS com as IMAGENS
                for (var i = 1; i <= 5; i++) {
                    nomeImagem = $("#imagem_" + i).attr("src");

                    if (nomeImagem != "")
                    {
                        quantasImagens = (parseInt(quantasImagens + 1));
                    }

                    //Esconde ícnoes de EXCLUSÃO
                    $("#excluir_imagem_" + i).hide();
                    $("#imagem_" + i).attr("src", "");

                    nomeImagem = "";
                }

                //Altera status de exibição de 'adicionar fotos' para 'ver fotos'
                if (parseInt(quantasImagens) > 0)
                {
                    $("#inQuantasFotosAnexadas_" + $("#ID_PRODUTO_FOTOS").val()).val(quantasImagens);
                    $("#adicionarFotos_" + $("#ID_PRODUTO_FOTOS").val()).hide();
                    $("#verFotos_" + $("#ID_PRODUTO_FOTOS").val()).show();
                }
                else if (parseInt(quantasImagens) == 0) {
                    $("#inQuantasFotosAnexadas_" + $("#ID_PRODUTO_FOTOS").val()).val(0);
                    $("#verFotos_" + $("#ID_PRODUTO_FOTOS").val()).hide();
                    $("#adicionarFotos_" + $("#ID_PRODUTO_FOTOS").val()).show();
                }
            });

            //Ao FECHAR POPUP de EXIBIÇÃO de IMAGENS
            $("#fecharPopUpImagens2").click(function () {
                //debugger;
                var nomeImagem = "";
                var quantasImagens = 0;

                $("#BOTAO_CONFIRMAR_FOTOS").val(0); //Reinicializa variável de controle da ação de FECHAR POPUP
                $("#QUANTIDADE_FOTOS_NOPRODUTO").val(0); //Reinicializa a variável de quantidade de fotos
                $("#excluir_todas_ver").hide(); //Esconder link EXCLUIR TODAS

                //Apurar quantidade de IMAGENS inseridas, esconder ícones de EXCLUSÃO individual e limpar QUADROS com as IMAGENS
                for (var i = 1; i <= 5; i++) {
                    nomeImagem = $("#imagem_" + i + "_ver").attr("src");

                    if (nomeImagem != "") {
                        quantasImagens = (parseInt(quantasImagens + 1));
                    }

                    //Esconde ícones de EXCLUSÃO
                    $("#ver_excluir_imagem_" + i).hide();
                    $("#imagem_" + i + "_ver").attr("src", "");

                    nomeImagem = "";
                }

                if (parseInt(quantasImagens) > 0) {
                    //Altera status de exibição de 'adicionar fotos' para 'ver fotos'
                    $("#inQuantasFotosAnexadas_" + $("#ID_PRODUTO_FOTOS").val()).val(quantasImagens);
                    $("#verFotos_" + $("#ID_PRODUTO_FOTOS").val()).show();
                    $("#adicionarFotos_" + $("#ID_PRODUTO_FOTOS").val()).hide();
                }
                else if (parseInt(quantasImagens) == 0) {
                    //Altera status de exibição de 'ver fotos' para 'adicionar fotos'
                    $("#inQuantasFotosAnexadas_" + $("#ID_PRODUTO_FOTOS").val()).val(0);
                    $("#verFotos_" + $("#ID_PRODUTO_FOTOS").val()).hide();
                    $("#adicionarFotos_" + $("#ID_PRODUTO_FOTOS").val()).show();
                }
            });

            $("#editarCotacao").click(function () {
                //Re-habilita campos digitáveis, quando se deseja ALTERAR a mesma
                $(".valorResposta").removeAttr('disabled');
                $(".check").removeAttr('disabled');
                $("#CONDICAO_PAGAMENTO_COTACAO_USUARIO_COTANTE").removeAttr('disabled');
                $("#ID_TIPO_DE_FRETE").removeAttr('disabled');
                $("#PERCENTUAL_DESCONTO_ASER_APLICADO").removeAttr('disabled');
                $(".radio0").removeAttr('disabled');
                $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").removeAttr('disabled');
                //$(".imagemProduto").bind('click', false); //Desabilita os links
                $('.imagemProduto').unbind('click', false); //Re-habilita os links
                $("#responderACotacao").removeAttr('disabled');
            });

            //Botão de CONFIRMAR FOTOS dos produtos alternativos
            $("#confirmarFotos").click(function () {
                $("#confirmarFotos").hide(); //Desliga o botão de CONFIRMAR FOTOS anexadas
                $("#BOTAO_CONFIRMAR_FOTOS").val(1); //Se tal variável for igual a 1, não exclui as fotos inseridas no bd
                $("#fecharPopUpImagens").click(); //Aciona o evento click para fechar o Popup

                $("#excluir_todas_inc").hide();
                $("#excluir_todas_ver").hide();

                alert('As fotos dos PRODUTOS ALTERNATIVOS foram anexadas com sucesso à COTAÇÃO.');
            });

            //Sair do sistema
            $("#linkSair").attr('tabindex', '-1');
        });

        //Desliga barra de progresso do UPLOAD
        function DesligaBarra() {
            $('#barra_progresso').hide();
        }

        //Executa ações quando o campo VALOR do PRODUTO COTADO é limpo
        function LimpaCampoTotal(id) {
            var campoValorProduto = "#inValorProduto_" + id;
            var campoTotalASerLimpo = "#inValorTotal_" + id;
            var exibicaoDesconto = "#comDescontoAplicado_" + id;

            //Setar valor '0' se o campo estiver vazio
            if ($(campoValorProduto).val() == "") {
                $(campoValorProduto).val('0,00');
            }

            if (($(campoValorProduto).val() == "") || ($(campoValorProduto).val() == "0,00")) {
                $(campoTotalASerLimpo).val(''); //Limpa campo de Total
                $(exibicaoDesconto).hide();

                if (document.getElementById(id).checked == true) {
                    $('#' + id).prop('checked', false); //Desmarca o CheckBox

                    //Só executa se o PREÇO PRODUTO não estiver zerado
                    if ($(campoValorProduto).val() > 0) {
                        var listaIdsProdutos = $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val().split(','); //Transforma string num array

                        //Excluir ID do PRODUTO do stringão
                        var indexProduto = listaIdsProdutos.indexOf(id);

                        listaIdsProdutos.splice(indexProduto, 1);
                        $("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val(listaIdsProdutos);
                    }
                }

                if ($("#IDS_PRODUTOS_SELECIONADOS_PARA_RESPOSTA_DA_COTACAO").val() == "") {
                    $("#PERCENTUAL_DESCONTO_ASER_APLICADO").val('');
                    $("#aplicarDescontos").hide("slow"); //Esconde os radioButtons de DESCONTO
                    $("#percentualDesconto").hide("slow"); //Esconde campo do percentual de desconto

                    $("#VALOR_TOTAL_DO_LOTE_DE_MERCADORIAS_SOMAR").val(moeda(0, 2, ",", "."));
                }
            }
            else {
                //Seta o checkBox como marcado, selecionando o PRODUTO, em caso de EDIÇÃO de COTAÇÃO
                if ($("#COTACAO_RESPONDIDA").val() == 'Sim') {
                    $('#' + id).prop('checked', true); //Marca o CheckBox
                }
            }
        }

        //Setar o PRODUTO que receberá as IMAGENS dos PRODUTOS ALTERNATIVOS
        function setarProdutoFotoAlternativa(id_produto) {
            var campoQuantidade = "#inQuantasFotosAnexadas_" + id_produto;

            $("#ID_PRODUTO_FOTOS").val(id_produto);
            $("#QUANTIDADE_FOTOS_NOPRODUTO").val($(campoQuantidade).val());
        }

        //Setar a IMAGEM que será EXCLUÍDA, se é a RECÉM-INCLUSA ou se é a já INSERIDA ANTERIORMENTE
        function setarQueImagemExcluir(tipo) {
            $("#TIPO_IMAGEM_EXCLUSAO").val(tipo);
        }

        function setarProdutoFotoAlternativa2(id_produto, idEmpresa, idUsuarioLogado) {
            var campoQuantidade = "#inQuantasFotosAnexadas_" + id_produto;

            $("#ID_PRODUTO_FOTOS").val(id_produto);
            $("#QUANTIDADE_FOTOS_NOPRODUTO").val($(campoQuantidade).val());

            //Exibe a opção de EXCLUIR TODAS, caso exista mais de 01 IMAGEM de produto anexada
            if ($("#QUANTIDADE_FOTOS_NOPRODUTO").val() > 1)
            {
                if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                    $("#excluir_todas_ver").show();
                }
            }

            //Ajax - Carrega as IMAGENS já anexadas à COTAÇÃO
            $.ajax({
                type: 'POST',
                url: '/UsuarioEmpresa/CarregarImagensDeProdutosAlternativosAnexadas', //Caminho Controler/Action
                dataType: 'json', //Tipo de dados
                data: { 'idProdutoCotacao': id_produto, 'tipoCotacao': $("#TIPO_COTACAO_RECEBIDA").val() }, //Valor passado por parâmetro
                success: function (result) {

                    if (result.imagemProdutoAlternativo1 != "")
                    {
                        $("#imagem_1_ver").attr("src", result.imagemProdutoAlternativo1);
                        $("#inIdVer_Foto_1").val(result.idDaImagemProduto1);

                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                            $("#ver_excluir_imagem_1").show();
                        }
                    }
                    else {
                        $("#imagem_1_ver").attr("src", "");
                        $("#inIdVer_Foto_1").val("");
                        $("#ver_excluir_imagem_1").hide();
                    }

                    if (result.imagemProdutoAlternativo2 != "")
                    {
                        $("#imagem_2_ver").attr("src", result.imagemProdutoAlternativo2);
                        $("#inIdVer_Foto_2").val(result.idDaImagemProduto2);

                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                            $("#ver_excluir_imagem_2").show();
                        }
                    }
                    else {
                        $("#imagem_2_ver").attr("src", "");
                        $("#inIdVer_Foto_2").val("");
                        $("#ver_excluir_imagem_2").hide();
                    }

                    if (result.imagemProdutoAlternativo3 != "")
                    {
                        $("#imagem_3_ver").attr("src", result.imagemProdutoAlternativo3);
                        $("#inIdVer_Foto_3").val(result.idDaImagemProduto3);

                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                            $("#ver_excluir_imagem_3").show();
                        }
                    }
                    else {
                        $("#imagem_3_ver").attr("src", "");
                        $("#inIdVer_Foto_3").val("");
                        $("#ver_excluir_imagem_3").hide();
                    }

                    if (result.imagemProdutoAlternativo4 != "")
                    {
                        $("#imagem_4_ver").attr("src", result.imagemProdutoAlternativo4);
                        $("#inIdVer_Foto_4").val(result.idDaImagemProduto4);

                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                            $("#ver_excluir_imagem_4").show();
                        }
                    }
                    else {
                        $("#imagem_4_ver").attr("src", "");
                        $("#inIdVer_Foto_4").val("");
                        $("#ver_excluir_imagem_4").hide();
                    }

                    if (result.imagemProdutoAlternativo5 != "")
                    {
                        $("#imagem_5_ver").attr("src", result.imagemProdutoAlternativo5);
                        $("#inIdVer_Foto_5").val(result.idDaImagemProduto5);

                        if ($("#STATUS_COTACAO_RECEBIDA").val() != 'ENCERRADA') {
                            $("#ver_excluir_imagem_5").show();
                        }
                    }
                    else {
                        $("#imagem_5_ver").attr("src", "");
                        $("#inIdVer_Foto_5").val("");
                        $("#ver_excluir_imagem_5").hide();
                    }
                }
            });

            //Desligar botão EXCLUIR TODAS, em caso de status 'ENCERRADA'
            if ($("#STATUS_COTACAO_RECEBIDA").val() == 'ENCERRADA') {
                $("#excluir_todas_ver").hide();
            }
        }

        //Alerta sobre a COTAÇÃO ENCERRADA
        function naoPode() {
            alert('ATENÇÃO!\n\nCotação Encerrada!');
        }

    </script>
}